{"version":3,"sources":["containers/PokerPlanning/message.factory.ts","containers/PokerPlanning/model.ts","containers/PokerPlanning/PokerCard.tsx","containers/PokerPlanning/styles.ts","containers/PokerPlanning/PokerOptionsForm.tsx","containers/PokerPlanning/services.ts","containers/PokerPlanning/index.tsx","components/FeatureTitle/index.tsx","components/CopyButton/index.tsx","services/string-utils.ts"],"names":["buildVoteMessage","username","value","type","payload","estimate","estimatedAtISO8601","Date","toISOString","undefined","POKER_PLANNING_RATINGS_FIBONNACI_ENHANCED","POKER_PLANNING_RATINGS_FIBONNACI","POKER_PLANNING_RATINGS_T_SHIRT_SIZES","POKER_PLANNING_RATINGS_T_SHIRT_SIZES_ENHENCED","sorterFactory","valuesArray","a","b","indexOf","CARDS_LISTING_CATEGORIES","fibonnacy","values","displayValue","slice","join","sorter","map","v","replace","DEFAULT_CARDS_LISTING_CATEGORY","DEFAULT_HOSTNAME","SOCKET_STATES","Map","WebSocket","CLOSED","OPEN","CLOSING","CONNECTING","PokerCard","isDisabled","isSelected","onClick","theme","useTheme","size","useIsWidthUp","Button","style","maxWidth","maxHeight","minWidth","minHeight","margin","spacing","variant","disabled","title","color","Typography","StyledTableCell","withStyles","body","fontSize","whiteSpace","wordBreak","TableCell","StyledTableRow","root","backgroundColor","palette","action","hover","TableRow","useStyles","makeStyles","toolbar","height","padding","marginLeft","formControl","marginRight","submitEstimate","marginTop","display","justifyContent","flexWrap","teamEstimates","tableHeader","primary","main","connect","state","lastPokerPlanningHostName","textInputs","lastPokerPlanningRoomName","lastPokerPlanningUsername","lastPokerCardsListingCategoryName","dispatch","storeInputText","name","setTextAction","socketState","classes","useParams","hostName","roomUUID","roomName","isReadyToStartSession","isNotBlank","cardsListingCategoryName","Grid","container","item","md","xs","FormControl","className","fullWidth","TextField","label","placeholder","onChange","e","target","InputProps","endAdornment","InputAdornment","position","IconButton","href","select","Object","entries","category","MenuItem","key","getSocketState","get","buildRouteURL","v4","buildFullRouteURL","params","document","location","split","mapStateToProps","mapDispatchToProps","props","navigate","useNavigate","showConfirmationDialog","useConfirmDialogContext","setToasterState","useToasterUpdate","socketRef","useRef","useState","setSocketState","myEstimate","setMyEstimate","postponedMessage","setPostponedMessage","isEstimatesVisible","setIsEstimatesVisible","pokerSession","setPokerSession","trim","estimates","pokerCards","filter","isNumeric","Number","estimatesSum","reduce","acc","val","average","length","estimatesAverage","Math","round","EPSILON","isEstimatesCleared","every","isUserMemberOfRoom","some","parseEstimates","isReadyToVote","isReadyToCreateNewRoom","useEffect","IS_DEV_MODE","console","info","myUserSessionEstimate","find","current","onSocketStateUpdate","onSessionUpdate","protocol","url","socket","ReconnectingWebSocket","onopen","readyState","onerror","onclose","onmessage","ev","session","JSON","parse","data","createSocket","close","sendOrPostpone","message","send","stringify","shareAsQRCode","QRCode","toDataURL","width","imgDataURL","fetch","response","blob","navigator","clipboard","write","ClipboardItem","open","autoHideDuration","error","Helmet","FeatureTitle","iconType","PockerPlanningIcon","alignItems","sx","mr","CopyButton","Icon","ShareLink","hoverMessage","feedbackMessage","updateMyEstimate","TableContainer","component","Paper","Table","TableHead","scope","align","description","onConfirm","TableBody","sort","estimateWhenDisplayON","estimateWhenDisplayOFF","buildRemoveUserMessage","titleWithIcon","titleContainer","icon","FeatureIcon","AssignmentTurnedIn","others","substring","copy","format","isBlank","str","isNaN"],"mappings":"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","file":"static/js/37.bc5e340c.chunk.js","sourcesContent":["import { UserEstimate, UserMessage } from './common.model';\n\nexport const buildVoteMessage = (username = '', value?: string): UserMessage<UserEstimate> => ({\n  type: 'vote',\n  payload: {\n    username,\n    estimate: value,\n    estimatedAtISO8601: value ? new Date().toISOString() : undefined,\n  },\n});\n\nexport const buildResetMessage = (): UserMessage => ({ type: 'reset' });\n\nexport const buildRemoveUserMessage = (username = ''): UserMessage<string> => ({ type: 'remove', payload: username });\n","import { UserEstimate } from './common.model';\n\nexport const POKER_PLANNING_RATINGS_FIBONNACI_ENHANCED: string[] = [\n  '?',\n  '0',\n  '0.5',\n  '1',\n  '1.5',\n  '2',\n  '2.5',\n  '3',\n  '3.5',\n  '4',\n  '4.5',\n  '5',\n  '8',\n  '13',\n  '20',\n  '40',\n  '100',\n];\n\nexport const POKER_PLANNING_RATINGS_FIBONNACI: string[] = ['?', '0', '1', '2', '3', '5', '8', '13', '20', '40', '100'];\n\nexport const POKER_PLANNING_RATINGS_T_SHIRT_SIZES: string[] = ['?', 'S', 'M', 'L', 'XL'];\n\nexport const POKER_PLANNING_RATINGS_T_SHIRT_SIZES_ENHENCED: string[] = ['?', 'XS', 'S', 'M', 'L', 'XL', 'XXL'];\n\nexport type CardsListingCategoryName = 'fibonnacy' | 'fibonnacy-variant-1' | 't-shirt' | 't-shirt-variant-1';\n\nexport type CardsListingCategory = {\n  values: string[];\n  displayValue: string;\n  sorter: (a: UserEstimate, b: UserEstimate) => number;\n};\n\ntype PokerVotesSorter = (a: UserEstimate, b: UserEstimate) => number;\nconst sorterFactory = (valuesArray: string[]): PokerVotesSorter => {\n  return (a: UserEstimate, b: UserEstimate) =>\n    valuesArray.indexOf(a.estimate ?? '?') - valuesArray.indexOf(b.estimate ?? '?');\n};\n\nexport const CARDS_LISTING_CATEGORIES: Record<CardsListingCategoryName, CardsListingCategory> = {\n  fibonnacy: {\n    values: POKER_PLANNING_RATINGS_FIBONNACI,\n    displayValue: POKER_PLANNING_RATINGS_FIBONNACI.slice(2).join(' '),\n    sorter: sorterFactory(POKER_PLANNING_RATINGS_FIBONNACI),\n  },\n  'fibonnacy-variant-1': {\n    values: POKER_PLANNING_RATINGS_FIBONNACI_ENHANCED,\n    displayValue: POKER_PLANNING_RATINGS_FIBONNACI_ENHANCED.slice(2)\n      .map(v => v.replace('0.5', '½'))\n      .map(v => v.replace('.5', '½'))\n      .join(' '),\n    sorter: sorterFactory(POKER_PLANNING_RATINGS_FIBONNACI_ENHANCED),\n  },\n  't-shirt': {\n    values: POKER_PLANNING_RATINGS_T_SHIRT_SIZES,\n    displayValue: POKER_PLANNING_RATINGS_T_SHIRT_SIZES.slice(1).join(' '),\n    sorter: sorterFactory(POKER_PLANNING_RATINGS_T_SHIRT_SIZES),\n  },\n  't-shirt-variant-1': {\n    values: POKER_PLANNING_RATINGS_T_SHIRT_SIZES_ENHENCED,\n    displayValue: POKER_PLANNING_RATINGS_T_SHIRT_SIZES_ENHENCED.slice(1).join(' '),\n    sorter: sorterFactory(POKER_PLANNING_RATINGS_T_SHIRT_SIZES_ENHENCED),\n  },\n};\n\nexport const DEFAULT_CARDS_LISTING_CATEGORY: CardsListingCategoryName = 'fibonnacy';\nexport const DEFAULT_ROOM_UUID = 'default';\nexport const DEFAULT_ROOM_NAME = 'default';\nexport const DEFAULT_HOSTNAME = 'localhost';\n\nexport type SocketState = 'open' | 'closed' | 'closing' | 'connecting';\n\nexport const SOCKET_STATES: Map<number, SocketState> = new Map([\n  [WebSocket.CLOSED, 'closed'],\n  [WebSocket.OPEN, 'open'],\n  [WebSocket.CLOSING, 'closing'],\n  [WebSocket.CONNECTING, 'connecting'],\n]);\n\nexport type EstimatesStats = {\n  values: number[];\n  estimatesSum: number;\n  estimatesAverage: number;\n  isEstimatesCleared: boolean;\n  isUserMemberOfRoom: boolean;\n};\n","import React from 'react';\n\nimport { Button, Typography, useTheme } from '@mui/material';\n\nimport { useIsWidthUp } from '../../theme';\n\ntype PokerCardType = {\n  value: string;\n  isDisabled: boolean;\n  isSelected: boolean;\n  onClick: (value: string) => void;\n};\n\nconst PokerCard: React.FC<PokerCardType> = ({ value, isDisabled, isSelected, onClick }) => {\n  const theme = useTheme();\n  const isMdUp = useIsWidthUp('md');\n  const size = isMdUp ? '70px' : '48px';\n\n  return (\n    <Button\n      style={{\n        maxWidth: size,\n        maxHeight: size,\n        minWidth: size,\n        minHeight: size,\n        margin: theme.spacing(1),\n      }}\n      variant={isSelected ? 'contained' : 'outlined'}\n      disabled={isDisabled}\n      title={`Estimate the current story point as: [${value}]`}\n      color=\"primary\"\n      onClick={() => onClick(value)}>\n      <Typography variant=\"h5\">{value}</Typography>\n    </Button>\n  );\n};\n\nexport default PokerCard;\n","import { TableCell, TableRow } from '@mui/material';\nimport { makeStyles, withStyles } from '@mui/styles';\n\nexport const StyledTableCell = withStyles(() => ({\n  body: {\n    fontSize: 14,\n    whiteSpace: 'normal',\n    wordBreak: 'break-word',\n  },\n}))(TableCell);\n\nexport const StyledTableRow = withStyles(theme => ({\n  root: {\n    '&:nth-of-type(even)': {\n      backgroundColor: theme.palette.action.hover,\n    },\n  },\n}))(TableRow);\n\nexport const useStyles = makeStyles(theme => ({\n  root: {\n    margin: theme.spacing(1),\n  },\n  toolbar: {\n    height: '100%',\n    margin: 0,\n    padding: 0,\n    '& > *': {\n      marginLeft: theme.spacing(1),\n    },\n  },\n  formControl: {\n    marginRight: theme.spacing(1),\n  },\n  submitEstimate: {\n    marginTop: theme.spacing(2),\n    display: 'flex',\n    justifyContent: 'center',\n    flexWrap: 'wrap',\n  },\n  teamEstimates: {\n    marginTop: theme.spacing(4),\n  },\n  tableHeader: {\n    backgroundColor: theme.palette.primary.main,\n  },\n}));\n","import React from 'react';\n\nimport HelpIcon from '@mui/icons-material/Help';\nimport { FormControl, Grid, IconButton, InputAdornment, MenuItem, useTheme } from '@mui/material';\nimport TextField from '@mui/material/TextField';\nimport { connect } from 'react-redux';\nimport { useParams } from 'react-router-dom';\nimport { Dispatch } from 'redux';\n\nimport { setTextAction } from '../../actions/text-actions';\nimport { AppState } from '../../reducers';\nimport { isNotBlank } from '../../services/string-utils';\nimport {\n  CARDS_LISTING_CATEGORIES,\n  CardsListingCategoryName,\n  DEFAULT_CARDS_LISTING_CATEGORY,\n  SocketState,\n} from './model';\nimport { useStyles } from './styles';\n\ntype PokerSettingsProps = {\n  socketState: SocketState;\n  lastPokerPlanningRoomName?: string;\n  lastPokerPlanningUsername?: string;\n  lastPokerPlanningHostName?: string;\n  lastPokerCardsListingCategoryName?: CardsListingCategoryName;\n  storeInputText: (name: string, value: string) => void;\n};\n\nconst PokerOptionsForm: React.FC<PokerSettingsProps> = ({\n  lastPokerPlanningRoomName,\n  lastPokerPlanningUsername,\n  lastPokerPlanningHostName,\n  lastPokerCardsListingCategoryName,\n  storeInputText,\n  socketState,\n}) => {\n  const classes = useStyles();\n  const theme = useTheme();\n  const { hostName, roomUUID, roomName } = useParams();\n\n  // computing\n  const isReadyToStartSession = isNotBlank(roomName) && isNotBlank(hostName) && isNotBlank(roomUUID);\n  const cardsListingCategoryName: CardsListingCategoryName = lastPokerCardsListingCategoryName\n    ? lastPokerCardsListingCategoryName\n    : DEFAULT_CARDS_LISTING_CATEGORY;\n\n  return (\n    <Grid container spacing={1}>\n      <Grid item md={4} xs={6}>\n        <FormControl className={classes.formControl} fullWidth={true}>\n          <TextField\n            label={`Serveur (channel ${socketState})`}\n            placeholder=\"Type the poker plannind hostname here\"\n            variant=\"outlined\"\n            fullWidth={true}\n            margin=\"normal\"\n            value={lastPokerPlanningHostName}\n            title={lastPokerPlanningHostName}\n            disabled={isReadyToStartSession}\n            onChange={e => storeInputText('lastPokerPlanningHostName', e.target.value)}\n            InputProps={{\n              endAdornment: (\n                <InputAdornment position=\"end\">\n                  <IconButton\n                    title=\"Instruction to setup a poker planning server\"\n                    target=\"_blank\"\n                    href=\"https://github.com/amwebexpert/ws-poker-planning#wspokerplanning-server-production-deployment\">\n                    <HelpIcon />\n                  </IconButton>\n                </InputAdornment>\n              ),\n            }}\n          />\n        </FormControl>\n      </Grid>\n      <Grid item md={2} xs={6}>\n        <FormControl className={classes.formControl} fullWidth={true}>\n          <TextField\n            label=\"Team name\"\n            placeholder=\"Type the team name here\"\n            variant=\"outlined\"\n            fullWidth={true}\n            margin=\"normal\"\n            value={lastPokerPlanningRoomName}\n            title={lastPokerPlanningRoomName}\n            disabled={isReadyToStartSession}\n            onChange={e => storeInputText('lastPokerPlanningRoomName', e.target.value)}\n          />\n        </FormControl>\n      </Grid>\n      <Grid item md={2} xs={6}>\n        <FormControl className={classes.formControl} fullWidth={true}>\n          <TextField\n            label=\"Your name\"\n            placeholder=\"Type your name here\"\n            variant=\"outlined\"\n            fullWidth={true}\n            margin=\"normal\"\n            value={lastPokerPlanningUsername}\n            onChange={e => storeInputText('lastPokerPlanningUsername', e.target.value)}\n          />\n        </FormControl>\n      </Grid>\n      <Grid item md={4} xs={6}>\n        <FormControl className={classes.formControl} fullWidth={true}>\n          <TextField\n            select={true}\n            label=\"Poker card types\"\n            style={{ marginTop: theme.spacing(2) }}\n            variant=\"outlined\"\n            fullWidth={true}\n            title={cardsListingCategoryName}\n            value={cardsListingCategoryName}\n            onChange={e => storeInputText('lastPokerCardsListingCategoryName', e.target.value)}>\n            {Object.entries(CARDS_LISTING_CATEGORIES).map(([name, category]) => (\n              <MenuItem key={name} value={name} title={name}>\n                {category.displayValue}\n              </MenuItem>\n            ))}\n          </TextField>\n        </FormControl>\n      </Grid>\n    </Grid>\n  );\n};\n\nexport function mapStateToProps(state: AppState) {\n  return {\n    lastPokerPlanningHostName: state.textInputs['lastPokerPlanningHostName'],\n    lastPokerPlanningRoomName: state.textInputs['lastPokerPlanningRoomName'],\n    lastPokerPlanningUsername: state.textInputs['lastPokerPlanningUsername'],\n    lastPokerCardsListingCategoryName: state.textInputs[\n      'lastPokerCardsListingCategoryName'\n    ] as CardsListingCategoryName,\n  };\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch) {\n  return {\n    storeInputText: (name: string, value: string) => dispatch(setTextAction(name, value)),\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PokerOptionsForm);\n","import ReconnectingWebSocket from 'reconnecting-websocket';\nimport { v4 } from 'uuid';\n\nimport { isNumeric } from '../../services/string-utils';\nimport { PokerPlanningSession, UserEstimate } from './common.model';\nimport { DEFAULT_HOSTNAME, DEFAULT_ROOM_NAME, EstimatesStats, SOCKET_STATES, SocketState } from './model';\n\ntype CreateSocketParams = {\n  hostName?: string;\n  roomUUID?: string;\n  onSocketStateUpdate: (socketState: SocketState) => void;\n  onSessionUpdate: (session: PokerPlanningSession) => void;\n};\n\nexport const createSocket = ({\n  hostName = DEFAULT_HOSTNAME,\n  roomUUID = v4(),\n  onSocketStateUpdate,\n  onSessionUpdate,\n}: CreateSocketParams): ReconnectingWebSocket => {\n  const protocol = document.location.protocol === 'https:' ? 'wss' : 'ws';\n  const url = `${protocol}://${hostName}/ws?roomUUID=${roomUUID}`;\n\n  const socket = new ReconnectingWebSocket(url);\n  socket.onopen = () => onSocketStateUpdate(getSocketState(socket.readyState));\n  socket.onerror = () => onSocketStateUpdate(getSocketState(socket.readyState));\n  socket.onclose = () => onSocketStateUpdate(getSocketState(socket.readyState));\n  socket.onmessage = (ev: MessageEvent<string>) => {\n    const session = JSON.parse(ev.data) as PokerPlanningSession;\n    onSessionUpdate(session);\n  };\n\n  return socket;\n};\n\nexport const parseEstimates = (estimates: UserEstimate[], username?: string): EstimatesStats => {\n  const values = estimates\n    .map(e => e.estimate)\n    .filter(e => !!e)\n    .filter(e => isNumeric(e))\n    .map(e => Number(e));\n  const estimatesSum = values.reduce((acc, val) => acc + Number(val), 0);\n  const average = values.length > 0 ? estimatesSum / values.length : 0;\n  const estimatesAverage = Math.round(average * 10 + Number.EPSILON) / 10;\n  const isEstimatesCleared = estimates.length > 0 && estimates.every(e => e.estimate === undefined);\n  const isUsernameProvided = !!username?.trim();\n  const isUserMemberOfRoom = isUsernameProvided && estimates.some(e => e.username === username);\n\n  return {\n    values,\n    estimatesSum,\n    estimatesAverage,\n    isEstimatesCleared,\n    isUserMemberOfRoom,\n  };\n};\n\nexport const getSocketState = (state: number): SocketState => SOCKET_STATES.get(state) ?? 'closed';\n\ntype BuildRouteURLParams = {\n  hostName?: string;\n  roomUUID?: string;\n  roomName?: string;\n};\n\nexport const buildRouteURL = ({\n  hostName = DEFAULT_HOSTNAME,\n  roomName = DEFAULT_ROOM_NAME,\n  roomUUID = v4(),\n}: BuildRouteURLParams) => `/PokerPlanning/${hostName}/${roomUUID}/${roomName}`;\n\nexport const extractSinglePageAppHostnameAndPath = () => document.location.href.split('/#/')[0];\n\nexport const buildFullRouteURL = (params: BuildRouteURLParams) =>\n  extractSinglePageAppHostnameAndPath() + '/#' + buildRouteURL(params);\n","import React, { useEffect, useRef, useState } from 'react';\n\nimport { default as RemoveEstimates, default as RemoveUser } from '@mui/icons-material/DeleteOutline';\nimport PockerPlanningIcon from '@mui/icons-material/Filter3';\nimport QRCodeIcon from '@mui/icons-material/QrCode';\nimport ShareLink from '@mui/icons-material/Share';\nimport Visibility from '@mui/icons-material/Visibility';\nimport VisibilityOff from '@mui/icons-material/VisibilityOff';\nimport {\n  Grid,\n  IconButton,\n  Paper,\n  Table,\n  TableBody,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Typography,\n} from '@mui/material';\nimport Button from '@mui/material/Button';\nimport QRCode from 'qrcode';\nimport { Helmet } from 'react-helmet';\nimport { connect } from 'react-redux';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport ReconnectingWebSocket from 'reconnecting-websocket';\nimport { Dispatch } from 'redux';\n\nimport { setTextAction } from '../../actions/text-actions';\nimport { useConfirmDialogContext } from '../../components/ConfirmDialog/ConfirmDialogProvider';\nimport CopyButton from '../../components/CopyButton';\nimport FeatureTitle from '../../components/FeatureTitle';\nimport { useToasterUpdate } from '../../components/Toaster/ToasterProvider';\nimport { AppState } from '../../reducers';\nimport { isNotBlank } from '../../services/string-utils';\nimport { IS_DEV_MODE } from '../../services/utils';\nimport { PokerPlanningSession, UserMessage } from './common.model';\nimport { buildRemoveUserMessage, buildResetMessage, buildVoteMessage } from './message.factory';\nimport {\n  CARDS_LISTING_CATEGORIES,\n  CardsListingCategory,\n  CardsListingCategoryName,\n  DEFAULT_CARDS_LISTING_CATEGORY,\n  SocketState,\n} from './model';\nimport PokerCard from './PokerCard';\nimport PokerOptionsForm from './PokerOptionsForm';\nimport { buildFullRouteURL, buildRouteURL, createSocket, parseEstimates } from './services';\nimport { StyledTableCell, StyledTableRow, useStyles } from './styles';\n\ninterface Props {\n  lastPokerPlanningRoomName?: string;\n  lastPokerPlanningUsername?: string;\n  lastPokerPlanningHostName?: string;\n  lastPokerCardsListingCategoryName?: CardsListingCategoryName;\n  storeInputText: (name: string, value: string) => void;\n}\n\nconst PokerPlanning: React.FC<Props> = (props: Props) => {\n  const classes = useStyles();\n  const navigate = useNavigate();\n  const { showConfirmationDialog } = useConfirmDialogContext();\n  const { setToasterState } = useToasterUpdate();\n\n  // component inputs\n  const { hostName, roomUUID, roomName } = useParams();\n  const {\n    lastPokerPlanningRoomName,\n    lastPokerPlanningUsername,\n    lastPokerPlanningHostName,\n    lastPokerCardsListingCategoryName,\n    storeInputText,\n  } = props;\n\n  // component state\n  const socketRef = useRef<ReconnectingWebSocket>();\n  const [socketState, setSocketState] = useState<SocketState>('closed');\n  const [myEstimate, setMyEstimate] = useState<string>();\n  const [postponedMessage, setPostponedMessage] = useState<UserMessage>();\n  const [isEstimatesVisible, setIsEstimatesVisible] = useState<boolean>(false);\n  const [pokerSession, setPokerSession] = useState<PokerPlanningSession>();\n\n  // computing\n  const title = `Poker planning ${lastPokerPlanningRoomName ?? ''}`.trim();\n  const estimates = pokerSession?.estimates ?? [];\n  const cardsListingCategoryName: CardsListingCategoryName = lastPokerCardsListingCategoryName\n    ? lastPokerCardsListingCategoryName\n    : DEFAULT_CARDS_LISTING_CATEGORY;\n  const pokerCards: CardsListingCategory = CARDS_LISTING_CATEGORIES[cardsListingCategoryName];\n  const { estimatesAverage, isEstimatesCleared, isUserMemberOfRoom } = parseEstimates(\n    estimates,\n    lastPokerPlanningUsername,\n  );\n  const isReadyToStartSession = socketRef && isNotBlank(roomName) && isNotBlank(hostName) && isNotBlank(roomUUID);\n  const isReadyToVote = isReadyToStartSession && isNotBlank(lastPokerPlanningUsername);\n  const isReadyToCreateNewRoom = isNotBlank(lastPokerPlanningHostName) && isNotBlank(lastPokerPlanningRoomName);\n\n  // keep the store in sync whenever route params are updated\n  useEffect(() => {\n    if (isReadyToStartSession) {\n      storeInputText('lastPokerPlanningRoomName', roomName ?? '');\n      storeInputText('lastPokerPlanningHostName', hostName ?? '');\n    }\n  }, [roomName, hostName, storeInputText, isReadyToStartSession]);\n\n  // update current user vote\n  useEffect(() => {\n    if (!pokerSession || !lastPokerPlanningUsername) {\n      return;\n    }\n\n    if (IS_DEV_MODE) {\n      console.info('poker session', pokerSession);\n    }\n\n    const myUserSessionEstimate = pokerSession.estimates.find(e => e.username === lastPokerPlanningUsername);\n    if (myUserSessionEstimate) {\n      setMyEstimate(myUserSessionEstimate.estimate);\n    }\n  }, [lastPokerPlanningUsername, pokerSession]);\n\n  useEffect(() => {\n    if (!isReadyToStartSession) {\n      return;\n    }\n\n    socketRef.current = createSocket({\n      hostName,\n      roomUUID,\n      onSessionUpdate: setPokerSession,\n      onSocketStateUpdate: setSocketState,\n    });\n\n    // socket cleanup whenever component unmount\n    return () => socketRef.current?.close();\n  }, [socketRef, isReadyToStartSession, hostName, roomUUID]);\n\n  const handleCreateNewRoom = () => {\n    const url = buildRouteURL({ hostName: lastPokerPlanningHostName, roomName: lastPokerPlanningRoomName });\n    navigate(url, { replace: true });\n  };\n\n  useEffect(() => {\n    if (isEstimatesCleared) {\n      setIsEstimatesVisible(false);\n      setMyEstimate(undefined);\n    }\n  }, [isEstimatesCleared]);\n\n  const updateMyEstimate = (value?: string) => {\n    if (value !== myEstimate) {\n      setMyEstimate(value);\n      sendOrPostpone(buildVoteMessage(lastPokerPlanningUsername, value));\n    } else {\n      setMyEstimate(undefined); // user is un-voting\n      sendOrPostpone(buildVoteMessage(lastPokerPlanningUsername));\n    }\n  };\n\n  const sendOrPostpone = (message: UserMessage) => {\n    if (socketRef.current && socketState === 'open') {\n      socketRef.current.send(JSON.stringify(message));\n    } else {\n      setPostponedMessage(message);\n    }\n  };\n\n  const handleClearAllVotes = () =>\n    showConfirmationDialog({\n      title: 'Confirmation',\n      description: 'Are you sure you want to delete all votes?',\n      onConfirm: () => sendOrPostpone(buildResetMessage()),\n    });\n\n  // send delayed message (if any)\n  useEffect(() => {\n    if (socketRef.current && socketState === 'open' && postponedMessage) {\n      socketRef.current.send(JSON.stringify(postponedMessage));\n      setPostponedMessage(undefined);\n    }\n  }, [postponedMessage, socketState]);\n\n  const shareAsQRCode = async () => {\n    try {\n      const data = buildFullRouteURL({ hostName, roomUUID, roomName });\n      const imgDataURL = await QRCode.toDataURL(data, { type: 'image/png', width: 200 });\n      const response = await fetch(imgDataURL);\n      const blob = await response.blob();\n      // TODO We may have to do this workaround for Safari: https://stackoverflow.com/a/68241503/704681\n      await navigator.clipboard.write([new ClipboardItem({ 'image/png': blob })]);\n      setToasterState({ open: true, message: 'Image copied', type: 'success', autoHideDuration: 2000 });\n    } catch (e) {\n      console.error(e);\n      const errorMessage = `Unexpected copy error, see detail on console`;\n      setToasterState({ open: true, message: errorMessage, type: 'warning', autoHideDuration: 2000 });\n    }\n  };\n\n  return (\n    <>\n      <Helmet title={title} />\n\n      <div className={classes.root}>\n        <FeatureTitle iconType={PockerPlanningIcon} title={title} />\n\n        <Grid container>\n          <Grid item md={9} xs={12}>\n            <PokerOptionsForm socketState={socketState} />\n          </Grid>\n          <Grid item md={3} xs={12}>\n            <Grid container justifyContent=\"flex-end\" alignItems=\"center\" className={classes.toolbar}>\n              <Button\n                sx={{ mr: 1 }}\n                variant=\"contained\"\n                title=\"Register the team and start planning in a new room\"\n                color=\"primary\"\n                disabled={!isReadyToCreateNewRoom}\n                onClick={handleCreateNewRoom}>\n                New\n              </Button>\n              <Button\n                sx={{ mr: 1 }}\n                variant=\"contained\"\n                title=\"Enter existing room\"\n                color=\"primary\"\n                disabled={isUserMemberOfRoom || !isReadyToVote}\n                onClick={() => sendOrPostpone(buildVoteMessage(lastPokerPlanningUsername))}>\n                Join\n              </Button>\n              <CopyButton\n                sx={{ mr: 1 }}\n                isDisabled={!isReadyToStartSession}\n                data={buildFullRouteURL({ hostName, roomUUID, roomName })}\n                Icon={ShareLink}\n                hoverMessage=\"Copy link to clipboard for sharing\"\n                feedbackMessage=\"Link copied to clipboard, you can now share to all members\"\n              />\n              <Button\n                variant=\"contained\"\n                title=\"Copy QRCode for sharing\"\n                disabled={!isReadyToStartSession}\n                onClick={shareAsQRCode}\n                color=\"primary\">\n                <QRCodeIcon />\n              </Button>\n            </Grid>\n          </Grid>\n        </Grid>\n\n        <div className={classes.submitEstimate}>\n          {pokerCards.values.map(value => (\n            <PokerCard\n              key={value}\n              isDisabled={!isReadyToVote}\n              isSelected={myEstimate === value}\n              value={value}\n              onClick={() => updateMyEstimate(value)}\n            />\n          ))}\n        </div>\n\n        <TableContainer component={Paper} className={classes.teamEstimates}>\n          <Table size=\"small\">\n            <TableHead className={classes.tableHeader}>\n              <TableRow>\n                <StyledTableCell component=\"th\" scope=\"row\" width={30}></StyledTableCell>\n                <StyledTableCell component=\"th\" scope=\"row\">\n                  Team member\n                </StyledTableCell>\n                <StyledTableCell component=\"th\" scope=\"row\" align=\"center\">\n                  Points\n                  <IconButton\n                    title=\"Toggle story points visibility\"\n                    disabled={!isUserMemberOfRoom}\n                    onClick={() => setIsEstimatesVisible(v => !v)}>\n                    {isEstimatesVisible ? <VisibilityOff /> : <Visibility />}\n                  </IconButton>\n                  <IconButton onClick={handleClearAllVotes} title=\"Clear all votes\" disabled={!isUserMemberOfRoom}>\n                    <RemoveEstimates />\n                  </IconButton>\n                </StyledTableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {estimates.sort(pokerCards.sorter).map(({ username, estimate }) => {\n                const estimateWhenDisplayON = estimate ?? '…';\n                const estimateWhenDisplayOFF = estimate ? '✔' : '…';\n                return (\n                  <StyledTableRow key={username}>\n                    <StyledTableCell width={30}>\n                      <IconButton\n                        disabled={!isUserMemberOfRoom}\n                        onClick={() => sendOrPostpone(buildRemoveUserMessage(username))}\n                        title={`Remove user \"${username}\"`}>\n                        <RemoveUser />\n                      </IconButton>\n                    </StyledTableCell>\n                    <StyledTableCell>{username}</StyledTableCell>\n                    <StyledTableCell align=\"center\">\n                      {isEstimatesVisible ? estimateWhenDisplayON : estimateWhenDisplayOFF}\n                    </StyledTableCell>\n                  </StyledTableRow>\n                );\n              })}\n              <StyledTableRow key=\"average\">\n                <StyledTableCell width={30}></StyledTableCell>\n                <StyledTableCell>\n                  <Typography>Story points average</Typography>\n                </StyledTableCell>\n                <StyledTableCell align=\"center\">\n                  <Typography>{isEstimatesVisible ? estimatesAverage : ''}</Typography>\n                </StyledTableCell>\n              </StyledTableRow>\n            </TableBody>\n          </Table>\n        </TableContainer>\n      </div>\n    </>\n  );\n};\n\nexport function mapStateToProps(state: AppState) {\n  return {\n    lastPokerPlanningHostName: state.textInputs['lastPokerPlanningHostName'],\n    lastPokerPlanningRoomName: state.textInputs['lastPokerPlanningRoomName'],\n    lastPokerPlanningUsername: state.textInputs['lastPokerPlanningUsername'],\n    lastPokerCardsListingCategoryName: state.textInputs[\n      'lastPokerCardsListingCategoryName'\n    ] as CardsListingCategoryName,\n  };\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch) {\n  return {\n    storeInputText: (name: string, value: string) => dispatch(setTextAction(name, value)),\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PokerPlanning);\n","import React, { ElementType } from 'react';\n\nimport { Typography } from '@mui/material';\nimport { makeStyles } from '@mui/styles';\n\nconst useStyles = makeStyles(theme => ({\n  title: {\n    wordBreak: 'break-word',\n  },\n  titleWithIcon: {\n    display: 'flex',\n    alignItems: 'center',\n  },\n  titleContainer: {\n    display: 'flex',\n    justifyContent: 'center',\n  },\n  icon: {\n    height: '40px',\n    width: '40px',\n    marginRight: theme.spacing(1),\n  },\n}));\n\ninterface Props {\n  title: string;\n  iconType: ElementType;\n}\n\nconst FeatureTitle: React.FC<Props> = ({ title, iconType: FeatureIcon }) => {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.titleContainer}>\n      <div className={classes.titleWithIcon}>\n        <FeatureIcon className={classes.icon} />\n        <Typography variant=\"h5\" className={classes.title}>\n          {title}\n        </Typography>\n      </div>\n    </div>\n  );\n};\n\nexport default FeatureTitle;\n","import React from 'react';\n\nimport AssignmentTurnedIn from '@mui/icons-material/AssignmentTurnedIn';\nimport { Button, ButtonProps, SvgIconTypeMap } from '@mui/material';\nimport { OverridableComponent } from '@mui/material/OverridableComponent';\nimport * as copy from 'copy-to-clipboard';\n\nimport { useToasterUpdate } from '../Toaster/ToasterProvider';\n\ntype Props = {\n  data?: string;\n  isDisabled?: boolean;\n  hoverMessage?: string;\n  feedbackMessage?: string;\n  Icon?: OverridableComponent<SvgIconTypeMap<unknown, 'svg'>>;\n} & ButtonProps;\n\nconst CopyButton: React.FC<Props> = ({\n  data,\n  isDisabled,\n  hoverMessage,\n  feedbackMessage,\n  Icon = AssignmentTurnedIn,\n  ...others\n}: Props) => {\n  const { setToasterState } = useToasterUpdate();\n\n  const handleCopy = () => {\n    if (!data) {\n      return;\n    }\n\n    const message = feedbackMessage ?? `Content copied into clipboard: ${data.substring(0, 25)} …`;\n\n    copy.default(data, { format: 'text/plain' });\n    setToasterState({ open: true, message, type: 'success', autoHideDuration: 2000 });\n  };\n\n  return (\n    <Button\n      disabled={!data || isDisabled}\n      title={hoverMessage ?? 'Copy to clipboard'}\n      variant=\"contained\"\n      data-testid=\"copy-to-clipboard\"\n      color=\"primary\"\n      {...others}\n      onClick={handleCopy}>\n      <Icon />\n    </Button>\n  );\n};\n\nexport default CopyButton;\n","export function isBlank(str: string | undefined | null) {\n  if (!str || str.trim().length === 0) {\n    return true;\n  }\n\n  return false;\n}\n\nexport function isNotBlank(str: string | undefined | null) {\n  return !isBlank(str);\n}\n\nexport const isNumeric = (val?: string): boolean => !isNaN(Number(val));\n"],"sourceRoot":""}