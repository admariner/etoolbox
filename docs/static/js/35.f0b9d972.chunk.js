(this["webpackJsonpweb-toolbox"]=this["webpackJsonpweb-toolbox"]||[]).push([[35],{1070:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return ue})),n.d(t,"mapDispatchToProps",(function(){return me}));var a=n(13),r=n(353),o=n(270),i=n(165),c=n(271),s=n(386),l=n(268),u=n(265),m=n(272),d=n(64),j=n(288),b=n(266),f=n(925),p=n.n(f),h=n(922),g=n.n(h),O=n(923),v=n.n(O),x=n(422),P=n.n(x),k=n(924),y=n.n(k),N=n(0),C=n(95),S=n(97),I=n(8),U=n(98),w=n(140),R=n(304),D=n(301),T=n(392),E=n(74),L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return{type:"vote",payload:{username:e,estimate:t,estimatedAtISO8601:t?(new Date).toISOString():void 0}}},W=["?","0","0.5","1","1.5","2","2.5","3","3.5","4","4.5","5","8","13","20","40","100"],H=["?","0","1","2","3","5","8","13","20","40","100"],M=["?","S","M","L","XL"],J=["?","XS","S","M","L","XL","XXL"],V=function(e){return function(t,n){var a,r;return e.indexOf(null!==(a=t.estimate)&&void 0!==a?a:"?")-e.indexOf(null!==(r=n.estimate)&&void 0!==r?r:"?")}},X={fibonnacy:{values:H,displayValue:H.slice(2).join(" "),sorter:V(H)},"fibonnacy-variant-1":{values:W,displayValue:W.slice(2).map((function(e){return e.replace("0.5","\xbd")})).map((function(e){return e.replace(".5","\xbd")})).join(" "),sorter:V(W)},"t-shirt":{values:M,displayValue:M.slice(1).join(" "),sorter:V(M)},"t-shirt-variant-1":{values:J,displayValue:J.slice(1).join(" "),sorter:V(J)}},A="fibonnacy",z="localhost",B=new Map([[WebSocket.CLOSED,"closed"],[WebSocket.OPEN,"open"],[WebSocket.CLOSING,"closing"],[WebSocket.CONNECTING,"connecting"]]),G=n(37),F=n(2),Y=Object(j.a)()((function(e){var t=e.width,n=e.value,a=e.isDisabled,r=e.isSelected,o=e.onClick,i=Object(G.a)(),c=Object(j.c)("md",t)?"70px":"48px";return Object(F.jsx)(b.a,{style:{maxWidth:c,maxHeight:c,minWidth:c,minHeight:c,margin:i.spacing(1)},variant:r?"contained":"outlined",disabled:a,title:"Estimate the current story point as: [".concat(n,"]"),color:"primary",onClick:function(){return o(n)},children:Object(F.jsx)(d.a,{variant:"h5",children:n})})})),_=n(1061),q=n(1071),K=n(362),Q=n(343),Z=n(9),$=n(267),ee=n(260),te=Object(Z.a)((function(){return{body:{fontSize:14,whiteSpace:"normal",wordBreak:"break-word"}}}))($.a),ne=Object(Z.a)((function(e){return{root:{"&:nth-of-type(even)":{backgroundColor:e.palette.action.hover}}}}))(l.a),ae=Object(ee.a)((function(e){return{root:{margin:e.spacing(1)},toolbar:{height:"100%",margin:0,padding:0,"& > *":{marginLeft:e.spacing(1)}},formControl:{marginRight:e.spacing(1)},submitEstimate:{marginTop:e.spacing(2),display:"flex",justifyContent:"center",flexWrap:"wrap"},teamEstimates:{marginTop:e.spacing(4)},tableHeader:{backgroundColor:e.palette.primary.main}}}));var re=Object(S.b)((function(e){return{lastPokerPlanningHostName:e.textInputs.lastPokerPlanningHostName,lastPokerPlanningRoomUUID:e.textInputs.lastPokerPlanningRoomUUID,lastPokerPlanningRoomName:e.textInputs.lastPokerPlanningRoomName,lastPokerPlanningUsername:e.textInputs.lastPokerPlanningUsername,lastPokerCardsListingCategoryName:e.textInputs.lastPokerCardsListingCategoryName}}),(function(e){return{storeInputText:function(t,n){return e(Object(U.b)(t,n))}}}))(Object(j.a)()((function(e){var t=e.lastPokerPlanningRoomName,n=e.lastPokerPlanningUsername,o=e.lastPokerPlanningHostName,i=e.lastPokerCardsListingCategoryName,c=e.storeInputText,s=e.socketState,l=ae(),u=Object(G.a)(),m=i||A;return Object(F.jsxs)(r.a,{container:!0,spacing:1,children:[Object(F.jsx)(r.a,{item:!0,md:3,xs:6,children:Object(F.jsx)(_.a,{className:l.formControl,fullWidth:!0,children:Object(F.jsx)(Q.a,{label:"Serveur (channel ".concat(s,")"),placeholder:"Type the poker plannind hostname here",variant:"outlined",fullWidth:!0,margin:"normal",value:o,onChange:function(e){return c("lastPokerPlanningHostName",e.target.value)}})})}),Object(F.jsx)(r.a,{item:!0,md:2,xs:6,children:Object(F.jsx)(_.a,{className:l.formControl,fullWidth:!0,children:Object(F.jsx)(Q.a,{label:"Team name",placeholder:"Type the team name here",variant:"outlined",fullWidth:!0,margin:"normal",value:t,onChange:function(e){return c("lastPokerPlanningRoomName",e.target.value)}})})}),Object(F.jsx)(r.a,{item:!0,md:2,xs:6,children:Object(F.jsx)(_.a,{className:l.formControl,fullWidth:!0,children:Object(F.jsx)(Q.a,{label:"Your name",placeholder:"Type your name here",variant:"outlined",fullWidth:!0,margin:"normal",value:n,onChange:function(e){return c("lastPokerPlanningUsername",e.target.value)}})})}),Object(F.jsx)(r.a,{item:!0,md:5,xs:6,children:Object(F.jsx)(_.a,{className:l.formControl,fullWidth:!0,children:Object(F.jsx)(q.a,{style:{marginTop:u.spacing(2)},variant:"outlined",fullWidth:!0,title:m,value:m,onChange:function(e){return c("lastPokerCardsListingCategoryName",e.target.value)},children:Object.entries(X).map((function(e){var t=Object(a.a)(e,2),n=t[0],r=t[1];return Object(F.jsx)(K.a,{value:n,title:n,children:r.displayValue},n)}))})})})]})}))),oe=n(921),ie=n(1044),ce=function(e){var t;return null!==(t=B.get(e))&&void 0!==t?t:"closed"},se=function(e){var t=e.hostname,n=void 0===t?z:t,a=e.roomName,r=void 0===a?"default":a,o=e.roomUUID,i=void 0===o?Object(ie.a)():o;return"/PokerPlanning/".concat(n,"/").concat(i,"/").concat(r)},le=function(e){return document.location.href.split("/#/")[0]+"/#"+se(e)};function ue(e){return{lastPokerPlanningHostName:e.textInputs.lastPokerPlanningHostName,lastPokerPlanningRoomUUID:e.textInputs.lastPokerPlanningRoomUUID,lastPokerPlanningRoomName:e.textInputs.lastPokerPlanningRoomName,lastPokerPlanningUsername:e.textInputs.lastPokerPlanningUsername,lastPokerCardsListingCategoryName:e.textInputs.lastPokerCardsListingCategoryName}}function me(e){return{storeInputText:function(t,n){return e(Object(U.b)(t,n))}}}t.default=Object(S.b)(ue,me)(Object(j.a)()((function(e){var t,n=ae(),j=Object(I.m)(),f=Object(w.b)().showConfirmationDialog,h=Object(I.o)(),O=h.hostName,x=h.roomUUID,k=h.roomName,S=e.lastPokerPlanningRoomUUID,U=e.lastPokerPlanningRoomName,W=e.lastPokerPlanningUsername,H=e.lastPokerPlanningHostName,M=e.lastPokerCardsListingCategoryName,J=e.storeInputText,V=Object(N.useRef)(),B=Object(N.useState)("closed"),G=Object(a.a)(B,2),_=G[0],q=G[1],K=Object(N.useState)(),Q=Object(a.a)(K,2),Z=Q[0],$=Q[1],ee=Object(N.useState)(),ue=Object(a.a)(ee,2),me=ue[0],de=ue[1],je=Object(N.useState)(!1),be=Object(a.a)(je,2),fe=be[0],pe=be[1],he=Object(N.useState)(),ge=Object(a.a)(he,2),Oe=ge[0],ve=ge[1],xe="Poker planning ".concat(null!==U&&void 0!==U?U:"").trim(),Pe=null!==(t=null===Oe||void 0===Oe?void 0:Oe.estimates)&&void 0!==t?t:[],ke=X[M||A],ye=function(e,t){var n=e.map((function(e){return e.estimate})).filter((function(e){return!!e})).filter((function(e){return Object(T.c)(e)})).map((function(e){return Number(e)})),a=n.reduce((function(e,t){return e+Number(t)}),0),r=n.length>0?a/n.length:0;return{values:n,estimatesSum:a,estimatesAverage:Math.round(10*r+Number.EPSILON)/10,isEstimatesCleared:e.length>0&&e.every((function(e){return void 0===e.estimate})),isUserMemberOfRoom:!(null===t||void 0===t||!t.trim())&&e.some((function(e){return e.username===t}))}}(Pe,W),Ne=ye.estimatesAverage,Ce=ye.isEstimatesCleared,Se=ye.isUserMemberOfRoom,Ie=Object(T.b)(H)&&Object(T.b)(S)&&Object(T.b)(O)&&Object(T.b)(x),Ue=Object(T.b)(H)&&Object(T.b)(S)&&Object(T.b)(U)&&Object(T.b)(W);Object(N.useEffect)((function(){k&&x&&O&&(J("lastPokerPlanningRoomName",k),J("lastPokerPlanningRoomUUID",x),J("lastPokerPlanningHostName",O))}),[x,k,O,J]),Object(N.useEffect)((function(){if(Oe&&W){E.a&&console.info("poker session",Oe);var e=null===Oe||void 0===Oe?void 0:Oe.estimates.find((function(e){return e.username===W}));e&&$(e.estimate)}}),[W,Oe]),Object(N.useEffect)((function(){Ie&&(V.current=function(e){var t=e.hostname,n=void 0===t?z:t,a=e.roomUUID,r=void 0===a?Object(ie.a)():a,o=e.onSocketStateUpdate,i=e.onSessionUpdate,c="https:"===document.location.protocol?"wss":"ws",s="".concat(c,"://").concat(n,"/ws?roomUUID=").concat(r),l=new oe.a(s);return l.onopen=function(){return o(ce(l.readyState))},l.onerror=function(){return o(ce(l.readyState))},l.onclose=function(){return o(ce(l.readyState))},l.onmessage=function(e){var t=JSON.parse(e.data);i(t)},l}({hostname:H,roomUUID:S,onSessionUpdate:ve,onSocketStateUpdate:q}))}),[V,Ie,H,S]),Object(N.useEffect)((function(){return function(){var e;return null===(e=V.current)||void 0===e?void 0:e.close()}}),[]);Object(N.useEffect)((function(){Ce&&(pe(!1),$(void 0))}),[Ce]);var we=function(e){V.current&&"open"===_?V.current.send(JSON.stringify(e)):de(e)};return Object(N.useEffect)((function(){V.current&&"open"===_&&me&&(V.current.send(JSON.stringify(me)),de(void 0))}),[me,_]),Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(C.a,{title:xe}),Object(F.jsxs)("div",{className:n.root,children:[Object(F.jsx)(D.a,{iconType:g.a,title:xe}),Object(F.jsxs)(r.a,{container:!0,children:[Object(F.jsx)(r.a,{item:!0,md:9,xs:12,children:Object(F.jsx)(re,{socketState:_})}),Object(F.jsx)(r.a,{item:!0,md:3,xs:12,children:Object(F.jsxs)(r.a,{container:!0,justifyContent:"flex-end",alignItems:"center",className:n.toolbar,children:[Object(F.jsx)(b.a,{variant:"contained",title:"Instruction to setup a poker planning server",color:"primary",target:"_blank",href:"https://github.com/amwebexpert/ws-poker-planning#production-deployments",children:"?"}),Object(F.jsx)(b.a,{variant:"contained",title:"Register the team and start planning in a new room",color:"primary",onClick:function(){var e=se({hostname:H,roomName:U});j(e,{replace:!0})},children:"New"}),Object(F.jsx)(b.a,{variant:"contained",title:"Enter existing room",color:"primary",disabled:Se||!Ue,onClick:function(){return we(L(W))},children:"Join"}),Object(F.jsx)(R.a,{data:le({hostname:H,roomUUID:S,roomName:U}),Icon:v.a,hoverMessage:"Copy link to clipboard for sharing",feedbackMessage:"Link copied to clipboard, you can now share to all members"})]})})]}),Object(F.jsx)("div",{className:n.submitEstimate,children:ke.values.map((function(e){return Object(F.jsx)(Y,{isDisabled:!Ue,isSelected:Z===e,value:e,onClick:function(){return function(e){e!==Z?($(e),we(L(W,e))):($(void 0),we(L(W)))}(e)}},e)}))}),Object(F.jsx)(o.a,{component:i.a,className:n.teamEstimates,children:Object(F.jsxs)(c.a,{size:"small",children:[Object(F.jsx)(s.a,{className:n.tableHeader,children:Object(F.jsxs)(l.a,{children:[Object(F.jsx)(te,{component:"th",scope:"row",width:30}),Object(F.jsx)(te,{component:"th",scope:"row",children:"Team member"}),Object(F.jsxs)(te,{component:"th",scope:"row",align:"center",children:["Points",Object(F.jsx)(u.a,{title:"Toggle story points visibility",onClick:function(){return pe((function(e){return!e}))},children:fe?Object(F.jsx)(y.a,{}):Object(F.jsx)(P.a,{})}),Object(F.jsx)(u.a,{onClick:function(){return f({title:"Confirmation",description:"Are you sure you want to delete all votes?",onConfirm:function(){return we({type:"reset"})}})},title:"Clear all votes",children:Object(F.jsx)(p.a,{})})]})]})}),Object(F.jsxs)(m.a,{children:[Pe.sort(ke.sorter).map((function(e){var t=e.username,n=e.estimate,a=null!==n&&void 0!==n?n:"\u2026",r=n?"\u2714":"\u2026";return Object(F.jsxs)(ne,{children:[Object(F.jsx)(te,{width:30,children:Object(F.jsx)(u.a,{onClick:function(){return we(function(){return{type:"remove",payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""}}(t))},title:'Remove user "'.concat(t,'"'),children:Object(F.jsx)(p.a,{})})}),Object(F.jsx)(te,{children:t}),Object(F.jsx)(te,{align:"center",children:fe?a:r})]},t)})),Object(F.jsxs)(ne,{children:[Object(F.jsx)(te,{width:30}),Object(F.jsx)(te,{children:Object(F.jsx)(d.a,{children:"Story points average"})}),Object(F.jsx)(te,{align:"center",children:Object(F.jsx)(d.a,{children:fe?Ne:""})})]},"average")]})]})})]})]})})))},301:function(e,t,n){"use strict";var a=n(64),r=n(260),o=(n(0),n(2)),i=Object(r.a)((function(e){return{title:{wordBreak:"break-word"},titleWithIcon:{display:"flex",alignItems:"center"},titleContainer:{display:"flex",justifyContent:"center"},icon:{height:"40px",width:"40px",marginRight:e.spacing(1)}}}));t.a=function(e){var t=i(),n=e.iconType;return Object(o.jsx)("div",{className:t.titleContainer,children:Object(o.jsxs)("div",{className:t.titleWithIcon,children:[Object(o.jsx)(n,{className:t.icon}),Object(o.jsx)(a.a,{variant:"h5",className:t.title,children:e.title})]})})}},304:function(e,t,n){"use strict";var a=n(266),r=n(311),o=n.n(r),i=n(307),c=n.n(i),s=(n(0),n(96)),l=n(2);t.a=function(e){var t=e.data,n=e.hoverMessage,r=e.feedbackMessage,i=e.Icon,u=void 0===i?o.a:i,m=Object(s.c)().setToasterState;return Object(l.jsx)(a.a,{onClick:function(){if(t){var e=null!==r&&void 0!==r?r:"Content copied into clipboard: ".concat(t.substring(0,25)," \u2026");c.a(t,{format:"text/plain"}),m({open:!0,message:e,type:"success",autoHideDuration:2e3})}},disabled:!t,title:null!==n&&void 0!==n?n:"Copy to clipboard",variant:"contained",color:"primary",children:Object(l.jsx)(u,{})})}},392:function(e,t,n){"use strict";function a(e){return!e||0===e.trim().length}function r(e){return!a(e)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var o=function(e){return!isNaN(Number(e))}}}]);
//# sourceMappingURL=35.f0b9d972.chunk.js.map