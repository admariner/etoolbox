"use strict";(self.webpackChunkweb_toolbox=self.webpackChunkweb_toolbox||[]).push([[877],{84121:function(e,t,n){var a=n(45987),r=n(47313),o=n(94622),i=n(73477),l=n(92229),s=n.n(l),c=n(13729),u=["data","isDisabled","hoverMessage","feedbackMessage","Icon"];t.Z=function(e){var t=e.data,n=e.isDisabled,l=e.hoverMessage,m=e.feedbackMessage,d=e.Icon,p=void 0===d?o.Z:d,f=(0,a.Z)(e,u),g=(0,c.IR)().setToasterState;return r.createElement(i.Z,Object.assign({disabled:!t||n,title:null!==l&&void 0!==l?l:"Copy to clipboard",variant:"contained","data-testid":"copy-to-clipboard",color:"primary"},f,{onClick:function(){if(t){var e=null!==m&&void 0!==m?m:"Content copied into clipboard: ".concat(t.substring(0,25)," \u2026");s()(t,{format:"text/plain"}),g({open:!0,message:e,type:"success",autoHideDuration:2e3})}}}),r.createElement(p,null))}},87591:function(e,t,n){var a=n(47313),r=n(42669),o=(0,n(48070).Z)((function(e){return{title:{wordBreak:"break-word"},titleWithIcon:{display:"flex",alignItems:"center"},titleContainer:{display:"flex",justifyContent:"center"},icon:{height:"40px",width:"40px",marginRight:e.spacing(1)}}}));t.Z=function(e){var t=e.title,n=e.iconType,i=o();return a.createElement("div",{className:i.titleContainer},a.createElement("div",{className:i.titleWithIcon},a.createElement(n,{className:i.icon}),a.createElement(r.Z,{variant:"h5",className:i.title},t)))}},67877:function(e,t,n){n.r(t),n.d(t,{default:function(){return de},mapDispatchToProps:function(){return me},mapStateToProps:function(){return ue}});var a=n(74165),r=n(15861),o=n(29439),i=n(47313),l=n(96217),s=n(70353),c=n(47575),u=n(46845),m=n(10237),d=n(22611),p=n(82937),f=n(39874),g=n(32415),v=n(44874),h=n(90495),E=n(59629),k=n(18104),y=n(53805),P=n(42669),Z=n(73477),b=n(46316),N=n(90182),C=n(66135),S=n(58467),x=n(58506),I=n(15729),w=n(84121),U=n(87591),L=n(13729),D=n(38101),R=n(62031),T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return{type:"vote",payload:{username:e,estimate:t,estimatedAtISO8601:t?(new Date).toISOString():void 0}}},O=["?","0","0.5","1","1.5","2","2.5","3","3.5","4","4.5","5","8","13","20","40","100"],W=["?","0","1","2","3","5","8","13","20","40","100"],H=["?","S","M","L","XL"],j=["?","XS","S","M","L","XL","XXL"],M=function(e){return function(t,n){var a,r;return e.indexOf(null!==(a=t.estimate)&&void 0!==a?a:"?")-e.indexOf(null!==(r=n.estimate)&&void 0!==r?r:"?")}},A={fibonnacy:{values:W,displayValue:W.slice(2).join(" "),sorter:M(W)},"fibonnacy-variant-1":{values:O,displayValue:O.slice(2).map((function(e){return e.replace("0.5","\xbd")})).map((function(e){return e.replace(".5","\xbd")})).join(" "),sorter:M(O)},"t-shirt":{values:H,displayValue:H.slice(1).join(" "),sorter:M(H)},"t-shirt-variant-1":{values:j,displayValue:j.slice(1).join(" "),sorter:M(j)}},V="fibonnacy",X="localhost",J=new Map([[WebSocket.CLOSED,"closed"],[WebSocket.OPEN,"open"],[WebSocket.CLOSING,"closing"],[WebSocket.CONNECTING,"connecting"]]),B=n(62111),_=n(63063),z=function(e){var t=e.value,n=e.isDisabled,a=e.isSelected,r=e.onClick,o=(0,B.Z)(),l=(0,_.NR)("md")?"70px":"48px";return i.createElement(Z.Z,{style:{maxWidth:l,maxHeight:l,minWidth:l,minHeight:l,margin:o.spacing(1)},variant:a?"contained":"outlined",disabled:n,title:"Estimate the current story point as: [".concat(t,"]"),color:"primary",onClick:function(){return r(t)}},i.createElement(P.Z,{variant:"h5"},t))},G=n(44565),$=n(10383),q=n(59017),F=n(81962),Q=n(67881),Y=n(37982),K=n(46241),ee=n(48070),te=(0,K.Z)((function(){return{body:{fontSize:14,whiteSpace:"normal",wordBreak:"break-word"}}}))(Y.Z),ne=(0,K.Z)((function(e){return{root:{"&:nth-of-type(even)":{backgroundColor:e.palette.action.hover}}}}))(E.Z),ae=(0,ee.Z)((function(e){return{root:{margin:e.spacing(1)},toolbar:{height:"100%",margin:0,padding:0,"& > *":{marginLeft:e.spacing(1)}},formControl:{marginRight:e.spacing(1)},submitEstimate:{marginTop:e.spacing(2),display:"flex",justifyContent:"center",flexWrap:"wrap"},teamEstimates:{marginTop:e.spacing(4)},tableHeader:{backgroundColor:e.palette.primary.main}}}));var re=(0,C.$j)((function(e){return{lastPokerPlanningHostName:e.textInputs.lastPokerPlanningHostName,lastPokerPlanningRoomName:e.textInputs.lastPokerPlanningRoomName,lastPokerPlanningUsername:e.textInputs.lastPokerPlanningUsername,lastPokerCardsListingCategoryName:e.textInputs.lastPokerCardsListingCategoryName}}),(function(e){return{storeInputText:function(t,n){return e((0,x.j)(t,n))}}}))((function(e){var t=e.lastPokerPlanningRoomName,n=e.lastPokerPlanningUsername,a=e.lastPokerPlanningHostName,r=e.lastPokerCardsListingCategoryName,l=e.storeInputText,s=e.socketState,c=ae(),u=(0,B.Z)(),m=(0,S.UO)(),d=m.hostName,f=m.roomUUID,g=m.roomName,v=(0,D.SL)(g)&&(0,D.SL)(d)&&(0,D.SL)(f),h=r||V;return i.createElement(p.ZP,{container:!0,spacing:1},i.createElement(p.ZP,{item:!0,md:4,xs:6},i.createElement($.Z,{className:c.formControl,fullWidth:!0},i.createElement(Q.Z,{label:"Serveur (channel ".concat(s,")"),placeholder:"Type the poker plannind hostname here",variant:"outlined",fullWidth:!0,margin:"normal",value:a,title:a,disabled:v,onChange:function(e){return l("lastPokerPlanningHostName",e.target.value)},InputProps:{endAdornment:i.createElement(q.Z,{position:"end"},i.createElement(k.Z,{title:"Instruction to setup a poker planning server",target:"_blank",href:"https://github.com/amwebexpert/ws-poker-planning#wspokerplanning-server-production-deployment"},i.createElement(G.Z,null)))}}))),i.createElement(p.ZP,{item:!0,md:2,xs:6},i.createElement($.Z,{className:c.formControl,fullWidth:!0},i.createElement(Q.Z,{label:"Team name",placeholder:"Type the team name here",variant:"outlined",fullWidth:!0,margin:"normal",value:t,title:t,disabled:v,onChange:function(e){return l("lastPokerPlanningRoomName",e.target.value)}}))),i.createElement(p.ZP,{item:!0,md:2,xs:6},i.createElement($.Z,{className:c.formControl,fullWidth:!0},i.createElement(Q.Z,{label:"Your name",placeholder:"Type your name here",variant:"outlined",fullWidth:!0,margin:"normal",value:n,onChange:function(e){return l("lastPokerPlanningUsername",e.target.value)}}))),i.createElement(p.ZP,{item:!0,md:4,xs:6},i.createElement($.Z,{className:c.formControl,fullWidth:!0},i.createElement(Q.Z,{select:!0,label:"Poker card types",style:{marginTop:u.spacing(2)},variant:"outlined",fullWidth:!0,title:h,value:h,onChange:function(e){return l("lastPokerCardsListingCategoryName",e.target.value)}},Object.entries(A).map((function(e){var t=(0,o.Z)(e,2),n=t[0],a=t[1];return i.createElement(F.Z,{key:n,value:n,title:n},a.displayValue)}))))))})),oe=n(3824),ie=n(24837),le=function(e){var t;return null!==(t=J.get(e))&&void 0!==t?t:"closed"},se=function(e){var t=e.hostName,n=void 0===t?X:t,a=e.roomName,r=void 0===a?"default":a,o=e.roomUUID,i=void 0===o?(0,ie.Z)():o;return"/PokerPlanning/".concat(n,"/").concat(i,"/").concat(r)},ce=function(e){return document.location.href.split("/#/")[0]+"/#"+se(e)};function ue(e){return{lastPokerPlanningHostName:e.textInputs.lastPokerPlanningHostName,lastPokerPlanningRoomName:e.textInputs.lastPokerPlanningRoomName,lastPokerPlanningUsername:e.textInputs.lastPokerPlanningUsername,lastPokerCardsListingCategoryName:e.textInputs.lastPokerCardsListingCategoryName}}function me(e){return{storeInputText:function(t,n){return e((0,x.j)(t,n))}}}var de=(0,C.$j)(ue,me)((function(e){var t,n=ae(),C=(0,S.s0)(),x=(0,I.O)().showConfirmationDialog,O=(0,L.IR)().setToasterState,W=(0,S.UO)(),H=W.hostName,j=W.roomUUID,M=W.roomName,J=e.lastPokerPlanningRoomName,B=e.lastPokerPlanningUsername,_=e.lastPokerPlanningHostName,G=e.lastPokerCardsListingCategoryName,$=e.storeInputText,q=(0,i.useRef)(),F=(0,i.useState)("closed"),Q=(0,o.Z)(F,2),Y=Q[0],K=Q[1],ee=(0,i.useState)(),ue=(0,o.Z)(ee,2),me=ue[0],de=ue[1],pe=(0,i.useState)(),fe=(0,o.Z)(pe,2),ge=fe[0],ve=fe[1],he=(0,i.useState)(!1),Ee=(0,o.Z)(he,2),ke=Ee[0],ye=Ee[1],Pe=(0,i.useState)(),Ze=(0,o.Z)(Pe,2),be=Ze[0],Ne=Ze[1],Ce="Poker planning ".concat(null!==J&&void 0!==J?J:"").trim(),Se=null!==(t=null===be||void 0===be?void 0:be.estimates)&&void 0!==t?t:[],xe=A[G||V],Ie=function(e,t){var n=e.map((function(e){return e.estimate})).filter((function(e){return!!e})).filter((function(e){return(0,D.kE)(e)})).map((function(e){return Number(e)})),a=n.reduce((function(e,t){return e+Number(t)}),0),r=n.length>0?a/n.length:0;return{values:n,estimatesSum:a,estimatesAverage:Math.round(10*r+Number.EPSILON)/10,isEstimatesCleared:e.length>0&&e.every((function(e){return void 0===e.estimate})),isUserMemberOfRoom:!(null===t||void 0===t||!t.trim())&&e.some((function(e){return e.username===t}))}}(Se,B),we=Ie.estimatesAverage,Ue=Ie.isEstimatesCleared,Le=Ie.isUserMemberOfRoom,De=q&&(0,D.SL)(M)&&(0,D.SL)(H)&&(0,D.SL)(j),Re=De&&(0,D.SL)(B),Te=(0,D.SL)(_)&&(0,D.SL)(J);(0,i.useEffect)((function(){De&&($("lastPokerPlanningRoomName",null!==M&&void 0!==M?M:""),$("lastPokerPlanningHostName",null!==H&&void 0!==H?H:""))}),[M,H,$,De]),(0,i.useEffect)((function(){if(be&&B){R.NB&&console.info("poker session",be);var e=be.estimates.find((function(e){return e.username===B}));e&&de(e.estimate)}}),[B,be]),(0,i.useEffect)((function(){if(De)return q.current=function(e){var t=e.hostName,n=void 0===t?X:t,a=e.roomUUID,r=void 0===a?(0,ie.Z)():a,o=e.onSocketStateUpdate,i=e.onSessionUpdate,l="https:"===document.location.protocol?"wss":"ws",s="".concat(l,"://").concat(n,"/ws?roomUUID=").concat(r),c=new oe.Z(s);return c.onopen=function(){return o(le(c.readyState))},c.onerror=function(){return o(le(c.readyState))},c.onclose=function(){return o(le(c.readyState))},c.onmessage=function(e){var t=JSON.parse(e.data);i(t)},c}({hostName:H,roomUUID:j,onSessionUpdate:Ne,onSocketStateUpdate:K}),function(){var e;return null===(e=q.current)||void 0===e?void 0:e.close()}}),[q,De,H,j]);(0,i.useEffect)((function(){Ue&&(ye(!1),de(void 0))}),[Ue]);var Oe=function(e){q.current&&"open"===Y?q.current.send(JSON.stringify(e)):ve(e)};(0,i.useEffect)((function(){q.current&&"open"===Y&&ge&&(q.current.send(JSON.stringify(ge)),ve(void 0))}),[ge,Y]);var We=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var t,n,r,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=ce({hostName:H,roomUUID:j,roomName:M}),e.next=4,b.toDataURL(t,{type:"image/png",width:200});case 4:return n=e.sent,e.next=7,fetch(n);case 7:return r=e.sent,e.next=10,r.blob();case 10:return o=e.sent,e.next=13,navigator.clipboard.write([new ClipboardItem({"image/png":o})]);case 13:O({open:!0,message:"Image copied",type:"success",autoHideDuration:2e3}),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(0),console.error(e.t0),"Unexpected copy error, see detail on console",O({open:!0,message:"Unexpected copy error, see detail on console",type:"warning",autoHideDuration:2e3});case 21:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();return i.createElement(i.Fragment,null,i.createElement(N.q,{title:Ce}),i.createElement("div",{className:n.root},i.createElement(U.Z,{iconType:s.Z,title:Ce}),i.createElement(p.ZP,{container:!0},i.createElement(p.ZP,{item:!0,md:9,xs:12},i.createElement(re,{socketState:Y})),i.createElement(p.ZP,{item:!0,md:3,xs:12},i.createElement(p.ZP,{container:!0,justifyContent:"flex-end",alignItems:"center",className:n.toolbar},i.createElement(Z.Z,{sx:{mr:1},variant:"contained",title:"Register the team and start planning in a new room",color:"primary",disabled:!Te,onClick:function(){var e=se({hostName:_,roomName:J});C(e,{replace:!0})}},"New"),i.createElement(Z.Z,{sx:{mr:1},variant:"contained",title:"Enter existing room",color:"primary",disabled:Le||!Re,onClick:function(){return Oe(T(B))}},"Join"),i.createElement(w.Z,{sx:{mr:1},isDisabled:!De,data:ce({hostName:H,roomUUID:j,roomName:M}),Icon:u.Z,hoverMessage:"Copy link to clipboard for sharing",feedbackMessage:"Link copied to clipboard, you can now share to all members"}),i.createElement(Z.Z,{variant:"contained",title:"Copy QRCode for sharing",disabled:!De,onClick:We,color:"primary"},i.createElement(c.Z,null))))),i.createElement("div",{className:n.submitEstimate},xe.values.map((function(e){return i.createElement(z,{key:e,isDisabled:!Re,isSelected:me===e,value:e,onClick:function(){return function(e){e!==me?(de(e),Oe(T(B,e))):(de(void 0),Oe(T(B)))}(e)}})}))),i.createElement(f.Z,{component:g.Z,className:n.teamEstimates},i.createElement(v.Z,{size:"small"},i.createElement(h.Z,{className:n.tableHeader},i.createElement(E.Z,null,i.createElement(te,{component:"th",scope:"row",width:30}),i.createElement(te,{component:"th",scope:"row"},"Team member"),i.createElement(te,{component:"th",scope:"row",align:"center"},"Points",i.createElement(k.Z,{title:"Toggle story points visibility",disabled:!Le,onClick:function(){return ye((function(e){return!e}))}},ke?i.createElement(d.Z,null):i.createElement(m.Z,null)),i.createElement(k.Z,{onClick:function(){return x({title:"Confirmation",description:"Are you sure you want to delete all votes?",onConfirm:function(){return Oe({type:"reset"})}})},title:"Clear all votes",disabled:!Le},i.createElement(l.Z,null))))),i.createElement(y.Z,null,Se.sort(xe.sorter).map((function(e){var t=e.username,n=e.estimate,a=null!==n&&void 0!==n?n:"\u2026",r=n?"\u2714":"\u2026";return i.createElement(ne,{key:t},i.createElement(te,{width:30},i.createElement(k.Z,{disabled:!Le,onClick:function(){return Oe(function(){return{type:"remove",payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""}}(t))},title:'Remove user "'.concat(t,'"')},i.createElement(l.Z,null))),i.createElement(te,null,t),i.createElement(te,{align:"center"},ke?a:r))})),i.createElement(ne,{key:"average"},i.createElement(te,{width:30}),i.createElement(te,null,i.createElement(P.Z,null,"Story points average")),i.createElement(te,{align:"center"},i.createElement(P.Z,null,ke?we:""))))))))}))},38101:function(e,t,n){function a(e){return!e||0===e.trim().length}function r(e){return!a(e)}n.d(t,{SL:function(){return r},fp:function(){return a},kE:function(){return o}});var o=function(e){return!isNaN(Number(e))}}}]);