(this["webpackJsonpweb-toolbox"]=this["webpackJsonpweb-toolbox"]||[]).push([[37],{1140:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return Ee})),n.d(t,"mapDispatchToProps",(function(){return ke}));var a=n(17),r=n(29),o=n(12),i=n(0),l=n.n(i),c=n(984),s=n.n(c),u=n(982),m=n.n(u),d=n(146),p=n.n(d),f=n(455),b=n.n(f),g=n(477),v=n.n(g),h=n(983),E=n.n(h),k=n(425),y=n(333),N=n(199),O=n(334),P=n(516),j=n(332),C=n(328),x=n(335),S=n(90),w=n(326),I=n(541),U=n.n(I),D=n(132),T=n(134),L=n(14),R=n(135),W=n(165),H=n(355),M=n(352),J=n(133),A=n(420),V=n(93),X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return{type:"vote",payload:{username:e,estimate:t,estimatedAtISO8601:t?(new Date).toISOString():void 0}}},z=["?","0","0.5","1","1.5","2","2.5","3","3.5","4","4.5","5","8","13","20","40","100"],B=["?","0","1","2","3","5","8","13","20","40","100"],G=["?","S","M","L","XL"],F=["?","XS","S","M","L","XL","XXL"],Q=function(e){return function(t,n){var a,r;return e.indexOf(null!==(a=t.estimate)&&void 0!==a?a:"?")-e.indexOf(null!==(r=n.estimate)&&void 0!==r?r:"?")}},Y={fibonnacy:{values:B,displayValue:B.slice(2).join(" "),sorter:Q(B)},"fibonnacy-variant-1":{values:z,displayValue:z.slice(2).map((function(e){return e.replace("0.5","\xbd")})).map((function(e){return e.replace(".5","\xbd")})).join(" "),sorter:Q(z)},"t-shirt":{values:G,displayValue:G.slice(1).join(" "),sorter:Q(G)},"t-shirt-variant-1":{values:F,displayValue:F.slice(1).join(" "),sorter:Q(F)}},_="fibonnacy",q="localhost",K=new Map([[WebSocket.CLOSED,"closed"],[WebSocket.OPEN,"open"],[WebSocket.CLOSING,"closing"],[WebSocket.CONNECTING,"connecting"]]),Z=n(31),$=n(51),ee=function(e){var t=e.value,n=e.isDisabled,a=e.isSelected,r=e.onClick,o=Object(Z.a)(),i=Object($.e)("md")?"70px":"48px";return l.a.createElement(w.a,{style:{maxWidth:i,maxHeight:i,minWidth:i,minHeight:i,margin:o.spacing(1)},variant:a?"contained":"outlined",disabled:n,title:"Estimate the current story point as: [".concat(t,"]"),color:"primary",onClick:function(){return r(t)}},l.a.createElement(S.a,{variant:"h5"},t))},te=n(980),ne=n.n(te),ae=n(1170),re=n(622),oe=n(452),ie=n(401),le=n(340),ce=n(339),se=n(319),ue=Object(ce.a)((function(){return{body:{fontSize:14,whiteSpace:"normal",wordBreak:"break-word"}}}))(le.a),me=Object(ce.a)((function(e){return{root:{"&:nth-of-type(even)":{backgroundColor:e.palette.action.hover}}}}))(j.a),de=Object(se.a)((function(e){return{root:{margin:e.spacing(1)},toolbar:{height:"100%",margin:0,padding:0,"& > *":{marginLeft:e.spacing(1)}},formControl:{marginRight:e.spacing(1)},submitEstimate:{marginTop:e.spacing(2),display:"flex",justifyContent:"center",flexWrap:"wrap"},teamEstimates:{marginTop:e.spacing(4)},tableHeader:{backgroundColor:e.palette.primary.main}}}));var pe=Object(T.b)((function(e){return{lastPokerPlanningHostName:e.textInputs.lastPokerPlanningHostName,lastPokerPlanningRoomName:e.textInputs.lastPokerPlanningRoomName,lastPokerPlanningUsername:e.textInputs.lastPokerPlanningUsername,lastPokerCardsListingCategoryName:e.textInputs.lastPokerCardsListingCategoryName}}),(function(e){return{storeInputText:function(t,n){return e(Object(R.b)(t,n))}}}))((function(e){var t=e.lastPokerPlanningRoomName,n=e.lastPokerPlanningUsername,a=e.lastPokerPlanningHostName,r=e.lastPokerCardsListingCategoryName,i=e.storeInputText,c=e.socketState,s=de(),u=Object(Z.a)(),m=Object(L.o)(),d=m.hostName,p=m.roomUUID,f=m.roomName,b=Object(A.b)(f)&&Object(A.b)(d)&&Object(A.b)(p),g=r||_;return l.a.createElement(k.a,{container:!0,spacing:1},l.a.createElement(k.a,{item:!0,md:4,xs:6},l.a.createElement(ae.a,{className:s.formControl,fullWidth:!0},l.a.createElement(ie.a,{label:"Serveur (channel ".concat(c,")"),placeholder:"Type the poker plannind hostname here",variant:"outlined",fullWidth:!0,margin:"normal",value:a,title:a,disabled:b,onChange:function(e){return i("lastPokerPlanningHostName",e.target.value)},InputProps:{endAdornment:l.a.createElement(re.a,{position:"end"},l.a.createElement(C.a,{title:"Instruction to setup a poker planning server",target:"_blank",href:"https://github.com/amwebexpert/ws-poker-planning#wspokerplanning-server-production-deployment"},l.a.createElement(ne.a,null)))}}))),l.a.createElement(k.a,{item:!0,md:2,xs:6},l.a.createElement(ae.a,{className:s.formControl,fullWidth:!0},l.a.createElement(ie.a,{label:"Team name",placeholder:"Type the team name here",variant:"outlined",fullWidth:!0,margin:"normal",value:t,title:t,disabled:b,onChange:function(e){return i("lastPokerPlanningRoomName",e.target.value)}}))),l.a.createElement(k.a,{item:!0,md:2,xs:6},l.a.createElement(ae.a,{className:s.formControl,fullWidth:!0},l.a.createElement(ie.a,{label:"Your name",placeholder:"Type your name here",variant:"outlined",fullWidth:!0,margin:"normal",value:n,onChange:function(e){return i("lastPokerPlanningUsername",e.target.value)}}))),l.a.createElement(k.a,{item:!0,md:4,xs:6},l.a.createElement(ae.a,{className:s.formControl,fullWidth:!0},l.a.createElement(ie.a,{select:!0,label:"Poker card types",style:{marginTop:u.spacing(2)},variant:"outlined",fullWidth:!0,title:g,value:g,onChange:function(e){return i("lastPokerCardsListingCategoryName",e.target.value)}},Object.entries(Y).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return l.a.createElement(oe.a,{key:n,value:n,title:n},a.displayValue)}))))))})),fe=n(981),be=n(1104),ge=function(e){var t;return null!==(t=K.get(e))&&void 0!==t?t:"closed"},ve=function(e){var t=e.hostName,n=void 0===t?q:t,a=e.roomName,r=void 0===a?"default":a,o=e.roomUUID,i=void 0===o?Object(be.a)():o;return"/PokerPlanning/".concat(n,"/").concat(i,"/").concat(r)},he=function(e){return document.location.href.split("/#/")[0]+"/#"+ve(e)};function Ee(e){return{lastPokerPlanningHostName:e.textInputs.lastPokerPlanningHostName,lastPokerPlanningRoomName:e.textInputs.lastPokerPlanningRoomName,lastPokerPlanningUsername:e.textInputs.lastPokerPlanningUsername,lastPokerCardsListingCategoryName:e.textInputs.lastPokerCardsListingCategoryName}}function ke(e){return{storeInputText:function(t,n){return e(Object(R.b)(t,n))}}}t.default=Object(T.b)(Ee,ke)((function(e){var t,n=de(),c=Object(L.m)(),u=Object(W.b)().showConfirmationDialog,d=Object(J.c)().setToasterState,f=Object(L.o)(),g=f.hostName,h=f.roomUUID,I=f.roomName,T=e.lastPokerPlanningRoomName,R=e.lastPokerPlanningUsername,z=e.lastPokerPlanningHostName,B=e.lastPokerCardsListingCategoryName,G=e.storeInputText,F=Object(i.useRef)(),Q=Object(i.useState)("closed"),K=Object(o.a)(Q,2),Z=K[0],$=K[1],te=Object(i.useState)(),ne=Object(o.a)(te,2),ae=ne[0],re=ne[1],oe=Object(i.useState)(),ie=Object(o.a)(oe,2),le=ie[0],ce=ie[1],se=Object(i.useState)(!1),Ee=Object(o.a)(se,2),ke=Ee[0],ye=Ee[1],Ne=Object(i.useState)(),Oe=Object(o.a)(Ne,2),Pe=Oe[0],je=Oe[1],Ce="Poker planning ".concat(null!==T&&void 0!==T?T:"").trim(),xe=null!==(t=null===Pe||void 0===Pe?void 0:Pe.estimates)&&void 0!==t?t:[],Se=Y[B||_],we=function(e,t){var n=e.map((function(e){return e.estimate})).filter((function(e){return!!e})).filter((function(e){return Object(A.c)(e)})).map((function(e){return Number(e)})),a=n.reduce((function(e,t){return e+Number(t)}),0),r=n.length>0?a/n.length:0;return{values:n,estimatesSum:a,estimatesAverage:Math.round(10*r+Number.EPSILON)/10,isEstimatesCleared:e.length>0&&e.every((function(e){return void 0===e.estimate})),isUserMemberOfRoom:!(null===t||void 0===t||!t.trim())&&e.some((function(e){return e.username===t}))}}(xe,R),Ie=we.estimatesAverage,Ue=we.isEstimatesCleared,De=we.isUserMemberOfRoom,Te=F&&Object(A.b)(I)&&Object(A.b)(g)&&Object(A.b)(h),Le=Te&&Object(A.b)(R),Re=Object(A.b)(z)&&Object(A.b)(T);Object(i.useEffect)((function(){Te&&(G("lastPokerPlanningRoomName",null!==I&&void 0!==I?I:""),G("lastPokerPlanningHostName",null!==g&&void 0!==g?g:""))}),[I,g,G,Te]),Object(i.useEffect)((function(){if(Pe&&R){V.a&&console.info("poker session",Pe);var e=Pe.estimates.find((function(e){return e.username===R}));e&&re(e.estimate)}}),[R,Pe]),Object(i.useEffect)((function(){if(Te)return F.current=function(e){var t=e.hostName,n=void 0===t?q:t,a=e.roomUUID,r=void 0===a?Object(be.a)():a,o=e.onSocketStateUpdate,i=e.onSessionUpdate,l="https:"===document.location.protocol?"wss":"ws",c="".concat(l,"://").concat(n,"/ws?roomUUID=").concat(r),s=new fe.a(c);return s.onopen=function(){return o(ge(s.readyState))},s.onerror=function(){return o(ge(s.readyState))},s.onclose=function(){return o(ge(s.readyState))},s.onmessage=function(e){var t=JSON.parse(e.data);i(t)},s}({hostName:g,roomUUID:h,onSessionUpdate:je,onSocketStateUpdate:$}),function(){var e;return null===(e=F.current)||void 0===e?void 0:e.close()}}),[F,Te,g,h]);Object(i.useEffect)((function(){Ue&&(ye(!1),re(void 0))}),[Ue]);var We=function(e){F.current&&"open"===Z?F.current.send(JSON.stringify(e)):ce(e)};Object(i.useEffect)((function(){F.current&&"open"===Z&&le&&(F.current.send(JSON.stringify(le)),ce(void 0))}),[le,Z]);var He=function(){var e=Object(r.a)(Object(a.a)().mark((function e(){var t,n,r,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=he({hostName:g,roomUUID:h,roomName:I}),e.next=4,U.a.toDataURL(t,{type:"image/png",width:200});case 4:return n=e.sent,e.next=7,fetch(n);case 7:return r=e.sent,e.next=10,r.blob();case 10:return o=e.sent,e.next=13,navigator.clipboard.write([new ClipboardItem({"image/png":o})]);case 13:d({open:!0,message:"Image copied",type:"success",autoHideDuration:2e3}),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(0),console.error(e.t0),"Unexpected copy error, see detail on console",d({open:!0,message:"Unexpected copy error, see detail on console",type:"warning",autoHideDuration:2e3});case 21:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();return l.a.createElement(l.a.Fragment,null,l.a.createElement(D.a,{title:Ce}),l.a.createElement("div",{className:n.root},l.a.createElement(M.a,{iconType:m.a,title:Ce}),l.a.createElement(k.a,{container:!0},l.a.createElement(k.a,{item:!0,md:9,xs:12},l.a.createElement(pe,{socketState:Z})),l.a.createElement(k.a,{item:!0,md:3,xs:12},l.a.createElement(k.a,{container:!0,justifyContent:"flex-end",alignItems:"center",className:n.toolbar},l.a.createElement(w.a,{sx:{mr:1},variant:"contained",title:"Register the team and start planning in a new room",color:"primary",disabled:!Re,onClick:function(){var e=ve({hostName:z,roomName:T});c(e,{replace:!0})}},"New"),l.a.createElement(w.a,{sx:{mr:1},variant:"contained",title:"Enter existing room",color:"primary",disabled:De||!Le,onClick:function(){return We(X(R))}},"Join"),l.a.createElement(H.a,{sx:{mr:1},isDisabled:!Te,data:he({hostName:g,roomUUID:h,roomName:I}),Icon:b.a,hoverMessage:"Copy link to clipboard for sharing",feedbackMessage:"Link copied to clipboard, you can now share to all members"}),l.a.createElement(w.a,{variant:"contained",title:"Copy QRCode for sharing",disabled:!Te,onClick:He,color:"primary"},l.a.createElement(p.a,null))))),l.a.createElement("div",{className:n.submitEstimate},Se.values.map((function(e){return l.a.createElement(ee,{key:e,isDisabled:!Le,isSelected:ae===e,value:e,onClick:function(){return function(e){e!==ae?(re(e),We(X(R,e))):(re(void 0),We(X(R)))}(e)}})}))),l.a.createElement(y.a,{component:N.a,className:n.teamEstimates},l.a.createElement(O.a,{size:"small"},l.a.createElement(P.a,{className:n.tableHeader},l.a.createElement(j.a,null,l.a.createElement(ue,{component:"th",scope:"row",width:30}),l.a.createElement(ue,{component:"th",scope:"row"},"Team member"),l.a.createElement(ue,{component:"th",scope:"row",align:"center"},"Points",l.a.createElement(C.a,{title:"Toggle story points visibility",disabled:!De,onClick:function(){return ye((function(e){return!e}))}},ke?l.a.createElement(E.a,null):l.a.createElement(v.a,null)),l.a.createElement(C.a,{onClick:function(){return u({title:"Confirmation",description:"Are you sure you want to delete all votes?",onConfirm:function(){return We({type:"reset"})}})},title:"Clear all votes",disabled:!De},l.a.createElement(s.a,null))))),l.a.createElement(x.a,null,xe.sort(Se.sorter).map((function(e){var t=e.username,n=e.estimate,a=null!==n&&void 0!==n?n:"\u2026",r=n?"\u2714":"\u2026";return l.a.createElement(me,{key:t},l.a.createElement(ue,{width:30},l.a.createElement(C.a,{disabled:!De,onClick:function(){return We(function(){return{type:"remove",payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""}}(t))},title:'Remove user "'.concat(t,'"')},l.a.createElement(s.a,null))),l.a.createElement(ue,null,t),l.a.createElement(ue,{align:"center"},ke?a:r))})),l.a.createElement(me,{key:"average"},l.a.createElement(ue,{width:30}),l.a.createElement(ue,null,l.a.createElement(S.a,null,"Story points average")),l.a.createElement(ue,{align:"center"},l.a.createElement(S.a,null,ke?Ie:""))))))))}))},352:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(90),i=n(319),l=Object(i.a)((function(e){return{title:{wordBreak:"break-word"},titleWithIcon:{display:"flex",alignItems:"center"},titleContainer:{display:"flex",justifyContent:"center"},icon:{height:"40px",width:"40px",marginRight:e.spacing(1)}}}));t.a=function(e){var t=e.title,n=e.iconType,a=l();return r.a.createElement("div",{className:a.titleContainer},r.a.createElement("div",{className:a.titleWithIcon},r.a.createElement(n,{className:a.icon}),r.a.createElement(o.a,{variant:"h5",className:a.title},t)))}},355:function(e,t,n){"use strict";var a=n(363),r=n(0),o=n.n(r),i=n(368),l=n.n(i),c=n(326),s=n(361),u=n.n(s),m=n(133),d=["data","isDisabled","hoverMessage","feedbackMessage","Icon"];t.a=function(e){var t=e.data,n=e.isDisabled,r=e.hoverMessage,i=e.feedbackMessage,s=e.Icon,p=void 0===s?l.a:s,f=Object(a.a)(e,d),b=Object(m.c)().setToasterState;return o.a.createElement(c.a,Object.assign({},f,{onClick:function(){if(t){var e=null!==i&&void 0!==i?i:"Content copied into clipboard: ".concat(t.substring(0,25)," \u2026");u.a(t,{format:"text/plain"}),b({open:!0,message:e,type:"success",autoHideDuration:2e3})}},disabled:!t||n,title:null!==r&&void 0!==r?r:"Copy to clipboard",variant:"contained",color:"primary"}),o.a.createElement(p,null))}},420:function(e,t,n){"use strict";function a(e){return!e||0===e.trim().length}function r(e){return!a(e)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var o=function(e){return!isNaN(Number(e))}}}]);
//# sourceMappingURL=37.ede86b98.chunk.js.map