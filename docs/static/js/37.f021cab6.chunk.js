(this["webpackJsonpweb-toolbox"]=this["webpackJsonpweb-toolbox"]||[]).push([[37],{1163:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return ge})),n.d(t,"mapDispatchToProps",(function(){return ve}));var a=n(17),r=n(30),o=n(13),i=n(433),c=n(340),s=n(203),l=n(341),u=n(524),d=n(339),m=n(335),b=n(342),j=n(94),p=n(552),f=n.n(p),h=n(332),O=n(1004),g=n.n(O),v=n(1002),x=n.n(v),k=n(464),y=n.n(k),N=n(485),P=n.n(N),C=n(1003),S=n.n(C),w=n(150),I=n.n(w),U=n(0),D=n(137),T=n(139),L=n(14),E=n(140),R=n(169),W=n(361),H=n(358),M=n(428),J=n(97),A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return{type:"vote",payload:{username:e,estimate:t,estimatedAtISO8601:t?(new Date).toISOString():void 0}}},V=["?","0","0.5","1","1.5","2","2.5","3","3.5","4","4.5","5","8","13","20","40","100"],X=["?","0","1","2","3","5","8","13","20","40","100"],z=["?","S","M","L","XL"],B=["?","XS","S","M","L","XL","XXL"],G=function(e){return function(t,n){var a,r;return e.indexOf(null!==(a=t.estimate)&&void 0!==a?a:"?")-e.indexOf(null!==(r=n.estimate)&&void 0!==r?r:"?")}},F={fibonnacy:{values:X,displayValue:X.slice(2).join(" "),sorter:G(X)},"fibonnacy-variant-1":{values:V,displayValue:V.slice(2).map((function(e){return e.replace("0.5","\xbd")})).map((function(e){return e.replace(".5","\xbd")})).join(" "),sorter:G(V)},"t-shirt":{values:z,displayValue:z.slice(1).join(" "),sorter:G(z)},"t-shirt-variant-1":{values:B,displayValue:B.slice(1).join(" "),sorter:G(B)}},Q="fibonnacy",Y="localhost",_=new Map([[WebSocket.CLOSED,"closed"],[WebSocket.OPEN,"open"],[WebSocket.CLOSING,"closing"],[WebSocket.CONNECTING,"connecting"]]),q=n(33),K=n(55),Z=n(1),$=function(e){var t=e.value,n=e.isDisabled,a=e.isSelected,r=e.onClick,o=Object(q.a)(),i=Object(K.e)("md")?"70px":"48px";return Object(Z.jsx)(h.a,{style:{maxWidth:i,maxHeight:i,minWidth:i,minHeight:i,margin:o.spacing(1)},variant:a?"contained":"outlined",disabled:n,title:"Estimate the current story point as: [".concat(t,"]"),color:"primary",onClick:function(){return r(t)},children:Object(Z.jsx)(j.a,{variant:"h5",children:t})})},ee=n(1194),te=n(633),ne=n(461),ae=n(408),re=n(1e3),oe=n.n(re),ie=n(346),ce=n(345),se=n(325),le=Object(ce.a)((function(){return{body:{fontSize:14,whiteSpace:"normal",wordBreak:"break-word"}}}))(ie.a),ue=Object(ce.a)((function(e){return{root:{"&:nth-of-type(even)":{backgroundColor:e.palette.action.hover}}}}))(d.a),de=Object(se.a)((function(e){return{root:{margin:e.spacing(1)},toolbar:{height:"100%",margin:0,padding:0,"& > *":{marginLeft:e.spacing(1)}},formControl:{marginRight:e.spacing(1)},submitEstimate:{marginTop:e.spacing(2),display:"flex",justifyContent:"center",flexWrap:"wrap"},teamEstimates:{marginTop:e.spacing(4)},tableHeader:{backgroundColor:e.palette.primary.main}}}));var me=Object(T.b)((function(e){return{lastPokerPlanningHostName:e.textInputs.lastPokerPlanningHostName,lastPokerPlanningRoomName:e.textInputs.lastPokerPlanningRoomName,lastPokerPlanningUsername:e.textInputs.lastPokerPlanningUsername,lastPokerCardsListingCategoryName:e.textInputs.lastPokerCardsListingCategoryName}}),(function(e){return{storeInputText:function(t,n){return e(Object(E.b)(t,n))}}}))((function(e){var t=e.lastPokerPlanningRoomName,n=e.lastPokerPlanningUsername,a=e.lastPokerPlanningHostName,r=e.lastPokerCardsListingCategoryName,c=e.storeInputText,s=e.socketState,l=de(),u=Object(q.a)(),d=Object(L.p)(),b=d.hostName,j=d.roomUUID,p=d.roomName,f=Object(M.b)(p)&&Object(M.b)(b)&&Object(M.b)(j),h=r||Q;return Object(Z.jsxs)(i.a,{container:!0,spacing:1,children:[Object(Z.jsx)(i.a,{item:!0,md:4,xs:6,children:Object(Z.jsx)(ee.a,{className:l.formControl,fullWidth:!0,children:Object(Z.jsx)(ae.a,{label:"Serveur (channel ".concat(s,")"),placeholder:"Type the poker plannind hostname here",variant:"outlined",fullWidth:!0,margin:"normal",value:a,title:a,disabled:f,onChange:function(e){return c("lastPokerPlanningHostName",e.target.value)},InputProps:{endAdornment:Object(Z.jsx)(te.a,{position:"end",children:Object(Z.jsx)(m.a,{title:"Instruction to setup a poker planning server",target:"_blank",href:"https://github.com/amwebexpert/ws-poker-planning#wspokerplanning-server-production-deployment",children:Object(Z.jsx)(oe.a,{})})})}})})}),Object(Z.jsx)(i.a,{item:!0,md:2,xs:6,children:Object(Z.jsx)(ee.a,{className:l.formControl,fullWidth:!0,children:Object(Z.jsx)(ae.a,{label:"Team name",placeholder:"Type the team name here",variant:"outlined",fullWidth:!0,margin:"normal",value:t,title:t,disabled:f,onChange:function(e){return c("lastPokerPlanningRoomName",e.target.value)}})})}),Object(Z.jsx)(i.a,{item:!0,md:2,xs:6,children:Object(Z.jsx)(ee.a,{className:l.formControl,fullWidth:!0,children:Object(Z.jsx)(ae.a,{label:"Your name",placeholder:"Type your name here",variant:"outlined",fullWidth:!0,margin:"normal",value:n,onChange:function(e){return c("lastPokerPlanningUsername",e.target.value)}})})}),Object(Z.jsx)(i.a,{item:!0,md:4,xs:6,children:Object(Z.jsx)(ee.a,{className:l.formControl,fullWidth:!0,children:Object(Z.jsx)(ae.a,{select:!0,label:"Poker card types",style:{marginTop:u.spacing(2)},variant:"outlined",fullWidth:!0,title:h,value:h,onChange:function(e){return c("lastPokerCardsListingCategoryName",e.target.value)},children:Object.entries(F).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(Z.jsx)(ne.a,{value:n,title:n,children:a.displayValue},n)}))})})})]})})),be=n(1001),je=n(1124),pe=function(e){var t;return null!==(t=_.get(e))&&void 0!==t?t:"closed"},fe=function(e){var t=e.hostName,n=void 0===t?Y:t,a=e.roomName,r=void 0===a?"default":a,o=e.roomUUID,i=void 0===o?Object(je.a)():o;return"/PokerPlanning/".concat(n,"/").concat(i,"/").concat(r)},he=function(e){return document.location.href.split("/#/")[0]+"/#"+fe(e)},Oe=n(138);function ge(e){return{lastPokerPlanningHostName:e.textInputs.lastPokerPlanningHostName,lastPokerPlanningRoomName:e.textInputs.lastPokerPlanningRoomName,lastPokerPlanningUsername:e.textInputs.lastPokerPlanningUsername,lastPokerCardsListingCategoryName:e.textInputs.lastPokerCardsListingCategoryName}}function ve(e){return{storeInputText:function(t,n){return e(Object(E.b)(t,n))}}}t.default=Object(T.b)(ge,ve)((function(e){var t,n=de(),p=Object(L.n)(),O=Object(R.b)().showConfirmationDialog,v=Object(Oe.c)().setToasterState,k=Object(L.p)(),N=k.hostName,C=k.roomUUID,w=k.roomName,T=e.lastPokerPlanningRoomName,E=e.lastPokerPlanningUsername,V=e.lastPokerPlanningHostName,X=e.lastPokerCardsListingCategoryName,z=e.storeInputText,B=Object(U.useRef)(),G=Object(U.useState)("closed"),_=Object(o.a)(G,2),q=_[0],K=_[1],ee=Object(U.useState)(),te=Object(o.a)(ee,2),ne=te[0],ae=te[1],re=Object(U.useState)(),oe=Object(o.a)(re,2),ie=oe[0],ce=oe[1],se=Object(U.useState)(!1),ge=Object(o.a)(se,2),ve=ge[0],xe=ge[1],ke=Object(U.useState)(),ye=Object(o.a)(ke,2),Ne=ye[0],Pe=ye[1],Ce="Poker planning ".concat(null!==T&&void 0!==T?T:"").trim(),Se=null!==(t=null===Ne||void 0===Ne?void 0:Ne.estimates)&&void 0!==t?t:[],we=F[X||Q],Ie=function(e,t){var n=e.map((function(e){return e.estimate})).filter((function(e){return!!e})).filter((function(e){return Object(M.c)(e)})).map((function(e){return Number(e)})),a=n.reduce((function(e,t){return e+Number(t)}),0),r=n.length>0?a/n.length:0;return{values:n,estimatesSum:a,estimatesAverage:Math.round(10*r+Number.EPSILON)/10,isEstimatesCleared:e.length>0&&e.every((function(e){return void 0===e.estimate})),isUserMemberOfRoom:!(null===t||void 0===t||!t.trim())&&e.some((function(e){return e.username===t}))}}(Se,E),Ue=Ie.estimatesAverage,De=Ie.isEstimatesCleared,Te=Ie.isUserMemberOfRoom,Le=B&&Object(M.b)(w)&&Object(M.b)(N)&&Object(M.b)(C),Ee=Le&&Object(M.b)(E),Re=Object(M.b)(V)&&Object(M.b)(T);Object(U.useEffect)((function(){Le&&(z("lastPokerPlanningRoomName",null!==w&&void 0!==w?w:""),z("lastPokerPlanningHostName",null!==N&&void 0!==N?N:""))}),[w,N,z,Le]),Object(U.useEffect)((function(){if(Ne&&E){J.a&&console.info("poker session",Ne);var e=Ne.estimates.find((function(e){return e.username===E}));e&&ae(e.estimate)}}),[E,Ne]),Object(U.useEffect)((function(){if(Le)return B.current=function(e){var t=e.hostName,n=void 0===t?Y:t,a=e.roomUUID,r=void 0===a?Object(je.a)():a,o=e.onSocketStateUpdate,i=e.onSessionUpdate,c="https:"===document.location.protocol?"wss":"ws",s="".concat(c,"://").concat(n,"/ws?roomUUID=").concat(r),l=new be.a(s);return l.onopen=function(){return o(pe(l.readyState))},l.onerror=function(){return o(pe(l.readyState))},l.onclose=function(){return o(pe(l.readyState))},l.onmessage=function(e){var t=JSON.parse(e.data);i(t)},l}({hostName:N,roomUUID:C,onSessionUpdate:Pe,onSocketStateUpdate:K}),function(){var e;return null===(e=B.current)||void 0===e?void 0:e.close()}}),[B,Le,N,C]);Object(U.useEffect)((function(){De&&(xe(!1),ae(void 0))}),[De]);var We=function(e){B.current&&"open"===q?B.current.send(JSON.stringify(e)):ce(e)};Object(U.useEffect)((function(){B.current&&"open"===q&&ie&&(B.current.send(JSON.stringify(ie)),ce(void 0))}),[ie,q]);var He=function(){var e=Object(r.a)(Object(a.a)().mark((function e(){var t,n,r,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=he({hostName:N,roomUUID:C,roomName:w}),e.next=4,f.a.toDataURL(t,{type:"image/png",width:200});case 4:return n=e.sent,e.next=7,fetch(n);case 7:return r=e.sent,e.next=10,r.blob();case 10:return o=e.sent,e.next=13,navigator.clipboard.write([new ClipboardItem({"image/png":o})]);case 13:v({open:!0,message:"Image copied",type:"success",autoHideDuration:2e3}),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(0),console.error(e.t0),"Unexpected copy error, see detail on console",v({open:!0,message:"Unexpected copy error, see detail on console",type:"warning",autoHideDuration:2e3});case 21:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();return Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)(D.a,{title:Ce}),Object(Z.jsxs)("div",{className:n.root,children:[Object(Z.jsx)(H.a,{iconType:x.a,title:Ce}),Object(Z.jsxs)(i.a,{container:!0,children:[Object(Z.jsx)(i.a,{item:!0,md:9,xs:12,children:Object(Z.jsx)(me,{socketState:q})}),Object(Z.jsx)(i.a,{item:!0,md:3,xs:12,children:Object(Z.jsxs)(i.a,{container:!0,justifyContent:"flex-end",alignItems:"center",className:n.toolbar,children:[Object(Z.jsx)(h.a,{sx:{mr:1},variant:"contained",title:"Register the team and start planning in a new room",color:"primary",disabled:!Re,onClick:function(){var e=fe({hostName:V,roomName:T});p(e,{replace:!0})},children:"New"}),Object(Z.jsx)(h.a,{sx:{mr:1},variant:"contained",title:"Enter existing room",color:"primary",disabled:Te||!Ee,onClick:function(){return We(A(E))},children:"Join"}),Object(Z.jsx)(W.a,{sx:{mr:1},isDisabled:!Le,data:he({hostName:N,roomUUID:C,roomName:w}),Icon:y.a,hoverMessage:"Copy link to clipboard for sharing",feedbackMessage:"Link copied to clipboard, you can now share to all members"}),Object(Z.jsx)(h.a,{variant:"contained",title:"Copy QRCode for sharing",disabled:!Le,onClick:He,color:"primary",children:Object(Z.jsx)(I.a,{})})]})})]}),Object(Z.jsx)("div",{className:n.submitEstimate,children:we.values.map((function(e){return Object(Z.jsx)($,{isDisabled:!Ee,isSelected:ne===e,value:e,onClick:function(){return function(e){e!==ne?(ae(e),We(A(E,e))):(ae(void 0),We(A(E)))}(e)}},e)}))}),Object(Z.jsx)(c.a,{component:s.a,className:n.teamEstimates,children:Object(Z.jsxs)(l.a,{size:"small",children:[Object(Z.jsx)(u.a,{className:n.tableHeader,children:Object(Z.jsxs)(d.a,{children:[Object(Z.jsx)(le,{component:"th",scope:"row",width:30}),Object(Z.jsx)(le,{component:"th",scope:"row",children:"Team member"}),Object(Z.jsxs)(le,{component:"th",scope:"row",align:"center",children:["Points",Object(Z.jsx)(m.a,{title:"Toggle story points visibility",disabled:!Te,onClick:function(){return xe((function(e){return!e}))},children:ve?Object(Z.jsx)(S.a,{}):Object(Z.jsx)(P.a,{})}),Object(Z.jsx)(m.a,{onClick:function(){return O({title:"Confirmation",description:"Are you sure you want to delete all votes?",onConfirm:function(){return We({type:"reset"})}})},title:"Clear all votes",disabled:!Te,children:Object(Z.jsx)(g.a,{})})]})]})}),Object(Z.jsxs)(b.a,{children:[Se.sort(we.sorter).map((function(e){var t=e.username,n=e.estimate,a=null!==n&&void 0!==n?n:"\u2026",r=n?"\u2714":"\u2026";return Object(Z.jsxs)(ue,{children:[Object(Z.jsx)(le,{width:30,children:Object(Z.jsx)(m.a,{disabled:!Te,onClick:function(){return We(function(){return{type:"remove",payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""}}(t))},title:'Remove user "'.concat(t,'"'),children:Object(Z.jsx)(g.a,{})})}),Object(Z.jsx)(le,{children:t}),Object(Z.jsx)(le,{align:"center",children:ve?a:r})]},t)})),Object(Z.jsxs)(ue,{children:[Object(Z.jsx)(le,{width:30}),Object(Z.jsx)(le,{children:Object(Z.jsx)(j.a,{children:"Story points average"})}),Object(Z.jsx)(le,{align:"center",children:Object(Z.jsx)(j.a,{children:ve?Ue:""})})]},"average")]})]})})]})]})}))},358:function(e,t,n){"use strict";var a=n(94),r=n(325),o=(n(0),n(1)),i=Object(r.a)((function(e){return{title:{wordBreak:"break-word"},titleWithIcon:{display:"flex",alignItems:"center"},titleContainer:{display:"flex",justifyContent:"center"},icon:{height:"40px",width:"40px",marginRight:e.spacing(1)}}}));t.a=function(e){var t=i(),n=e.iconType;return Object(o.jsx)("div",{className:t.titleContainer,children:Object(o.jsxs)("div",{className:t.titleWithIcon,children:[Object(o.jsx)(n,{className:t.icon}),Object(o.jsx)(a.a,{variant:"h5",className:t.title,children:e.title})]})})}},361:function(e,t,n){"use strict";var a=n(27),r=n(369),o=n(332),i=n(374),c=n.n(i),s=n(367),l=n.n(s),u=(n(0),n(138)),d=n(1),m=["data","isDisabled","hoverMessage","feedbackMessage","Icon"];t.a=function(e){var t=e.data,n=e.isDisabled,i=e.hoverMessage,s=e.feedbackMessage,b=e.Icon,j=void 0===b?c.a:b,p=Object(r.a)(e,m),f=Object(u.c)().setToasterState;return Object(d.jsx)(o.a,Object(a.a)(Object(a.a)({},p),{},{onClick:function(){if(t){var e=null!==s&&void 0!==s?s:"Content copied into clipboard: ".concat(t.substring(0,25)," \u2026");l.a(t,{format:"text/plain"}),f({open:!0,message:e,type:"success",autoHideDuration:2e3})}},disabled:!t||n,title:null!==i&&void 0!==i?i:"Copy to clipboard",variant:"contained",color:"primary",children:Object(d.jsx)(j,{})}))}},428:function(e,t,n){"use strict";function a(e){return!e||0===e.trim().length}function r(e){return!a(e)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var o=function(e){return!isNaN(Number(e))}}}]);
//# sourceMappingURL=37.f021cab6.chunk.js.map