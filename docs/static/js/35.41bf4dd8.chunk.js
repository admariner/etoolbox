(this["webpackJsonpweb-toolbox"]=this["webpackJsonpweb-toolbox"]||[]).push([[35],{1071:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return be})),n.d(t,"mapDispatchToProps",(function(){return je}));var a=n(13),r=n(353),o=n(270),i=n(165),c=n(271),s=n(387),l=n(268),u=n(265),d=n(272),m=n(64),b=n(288),j=n(266),f=n(926),p=n.n(f),h=n(923),O=n.n(h),g=n(924),v=n.n(g),x=n(423),k=n.n(x),N=n(925),P=n.n(N),y=n(0),C=n(95),S=n(97),w=n(8),I=n(98),U=n(140),T=n(304),E=n(301),L=n(373),W=n(74),D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return{type:"vote",payload:{username:e,estimate:t,estimatedAtISO8601:t?(new Date).toISOString():void 0}}},R=["?","0","0.5","1","1.5","2","2.5","3","3.5","4","4.5","5","8","13","20","40","100"],H=["?","0","1","2","3","5","8","13","20","40","100"],M=["?","S","M","L","XL"],J=["?","XS","S","M","L","XL","XXL"],A=function(e){return function(t,n){var a,r;return e.indexOf(null!==(a=t.estimate)&&void 0!==a?a:"?")-e.indexOf(null!==(r=n.estimate)&&void 0!==r?r:"?")}},V={fibonnacy:{values:H,displayValue:H.slice(2).join(" "),sorter:A(H)},"fibonnacy-variant-1":{values:R,displayValue:R.slice(2).map((function(e){return e.replace("0.5","\xbd")})).map((function(e){return e.replace(".5","\xbd")})).join(" "),sorter:A(R)},"t-shirt":{values:M,displayValue:M.slice(1).join(" "),sorter:A(M)},"t-shirt-variant-1":{values:J,displayValue:J.slice(1).join(" "),sorter:A(J)}},X="fibonnacy",z="localhost",B=new Map([[WebSocket.CLOSED,"closed"],[WebSocket.OPEN,"open"],[WebSocket.CLOSING,"closing"],[WebSocket.CONNECTING,"connecting"]]),G=n(37),F=n(2),Y=Object(b.a)()((function(e){var t=e.width,n=e.value,a=e.isDisabled,r=e.isSelected,o=e.onClick,i=Object(G.a)(),c=Object(b.c)("md",t)?"70px":"48px";return Object(F.jsx)(j.a,{style:{maxWidth:c,maxHeight:c,minWidth:c,minHeight:c,margin:i.spacing(1)},variant:r?"contained":"outlined",disabled:a,title:"Estimate the current story point as: [".concat(n,"]"),color:"primary",onClick:function(){return o(n)},children:Object(F.jsx)(m.a,{variant:"h5",children:n})})})),_=n(1062),q=n(422),K=n(1072),Q=n(362),Z=n(343),$=n(921),ee=n.n($),te=n(9),ne=n(267),ae=n(260),re=Object(te.a)((function(){return{body:{fontSize:14,whiteSpace:"normal",wordBreak:"break-word"}}}))(ne.a),oe=Object(te.a)((function(e){return{root:{"&:nth-of-type(even)":{backgroundColor:e.palette.action.hover}}}}))(l.a),ie=Object(ae.a)((function(e){return{root:{margin:e.spacing(1)},toolbar:{height:"100%",margin:0,padding:0,"& > *":{marginLeft:e.spacing(1)}},formControl:{marginRight:e.spacing(1)},submitEstimate:{marginTop:e.spacing(2),display:"flex",justifyContent:"center",flexWrap:"wrap"},teamEstimates:{marginTop:e.spacing(4)},tableHeader:{backgroundColor:e.palette.primary.main}}}));var ce=Object(S.b)((function(e){return{lastPokerPlanningHostName:e.textInputs.lastPokerPlanningHostName,lastPokerPlanningRoomName:e.textInputs.lastPokerPlanningRoomName,lastPokerPlanningUsername:e.textInputs.lastPokerPlanningUsername,lastPokerCardsListingCategoryName:e.textInputs.lastPokerCardsListingCategoryName}}),(function(e){return{storeInputText:function(t,n){return e(Object(I.b)(t,n))}}}))(Object(b.a)()((function(e){var t=e.lastPokerPlanningRoomName,n=e.lastPokerPlanningUsername,o=e.lastPokerPlanningHostName,i=e.lastPokerCardsListingCategoryName,c=e.storeInputText,s=e.socketState,l=ie(),d=Object(G.a)(),m=Object(w.o)(),b=m.hostName,j=m.roomUUID,f=m.roomName,p=Object(L.b)(f)&&Object(L.b)(b)&&Object(L.b)(j),h=i||X;return Object(F.jsxs)(r.a,{container:!0,spacing:1,children:[Object(F.jsx)(r.a,{item:!0,md:3,xs:6,children:Object(F.jsx)(_.a,{className:l.formControl,fullWidth:!0,children:Object(F.jsx)(Z.a,{label:"Serveur (channel ".concat(s,")"),placeholder:"Type the poker plannind hostname here",variant:"outlined",fullWidth:!0,margin:"normal",value:o,disabled:p,onChange:function(e){return c("lastPokerPlanningHostName",e.target.value)},InputProps:{endAdornment:Object(F.jsx)(q.a,{position:"end",children:Object(F.jsx)(u.a,{title:"Instruction to setup a poker planning server",target:"_blank",href:"https://github.com/amwebexpert/ws-poker-planning#wspokerplanning-server-production-deployment",children:Object(F.jsx)(ee.a,{})})})}})})}),Object(F.jsx)(r.a,{item:!0,md:2,xs:6,children:Object(F.jsx)(_.a,{className:l.formControl,fullWidth:!0,children:Object(F.jsx)(Z.a,{label:"Team name",placeholder:"Type the team name here",variant:"outlined",fullWidth:!0,margin:"normal",value:t,disabled:p,onChange:function(e){return c("lastPokerPlanningRoomName",e.target.value)}})})}),Object(F.jsx)(r.a,{item:!0,md:2,xs:6,children:Object(F.jsx)(_.a,{className:l.formControl,fullWidth:!0,children:Object(F.jsx)(Z.a,{label:"Your name",placeholder:"Type your name here",variant:"outlined",fullWidth:!0,margin:"normal",value:n,onChange:function(e){return c("lastPokerPlanningUsername",e.target.value)}})})}),Object(F.jsx)(r.a,{item:!0,md:5,xs:6,children:Object(F.jsx)(_.a,{className:l.formControl,fullWidth:!0,children:Object(F.jsx)(K.a,{style:{marginTop:d.spacing(2)},variant:"outlined",fullWidth:!0,title:h,value:h,onChange:function(e){return c("lastPokerCardsListingCategoryName",e.target.value)},children:Object.entries(V).map((function(e){var t=Object(a.a)(e,2),n=t[0],r=t[1];return Object(F.jsx)(Q.a,{value:n,title:n,children:r.displayValue},n)}))})})})]})}))),se=n(922),le=n(1045),ue=function(e){var t;return null!==(t=B.get(e))&&void 0!==t?t:"closed"},de=function(e){var t=e.hostName,n=void 0===t?z:t,a=e.roomName,r=void 0===a?"default":a,o=e.roomUUID,i=void 0===o?Object(le.a)():o;return"/PokerPlanning/".concat(n,"/").concat(i,"/").concat(r)},me=function(e){return document.location.href.split("/#/")[0]+"/#"+de(e)};function be(e){return{lastPokerPlanningHostName:e.textInputs.lastPokerPlanningHostName,lastPokerPlanningRoomName:e.textInputs.lastPokerPlanningRoomName,lastPokerPlanningUsername:e.textInputs.lastPokerPlanningUsername,lastPokerCardsListingCategoryName:e.textInputs.lastPokerCardsListingCategoryName}}function je(e){return{storeInputText:function(t,n){return e(Object(I.b)(t,n))}}}t.default=Object(S.b)(be,je)(Object(b.a)()((function(e){var t,n=ie(),b=Object(w.m)(),f=Object(U.b)().showConfirmationDialog,h=Object(w.o)(),g=h.hostName,x=h.roomUUID,N=h.roomName,S=e.lastPokerPlanningRoomName,I=e.lastPokerPlanningUsername,R=e.lastPokerPlanningHostName,H=e.lastPokerCardsListingCategoryName,M=e.storeInputText,J=Object(y.useRef)(),A=Object(y.useState)("closed"),B=Object(a.a)(A,2),G=B[0],_=B[1],q=Object(y.useState)(),K=Object(a.a)(q,2),Q=K[0],Z=K[1],$=Object(y.useState)(),ee=Object(a.a)($,2),te=ee[0],ne=ee[1],ae=Object(y.useState)(!1),be=Object(a.a)(ae,2),je=be[0],fe=be[1],pe=Object(y.useState)(),he=Object(a.a)(pe,2),Oe=he[0],ge=he[1],ve="Poker planning ".concat(null!==S&&void 0!==S?S:"").trim(),xe=null!==(t=null===Oe||void 0===Oe?void 0:Oe.estimates)&&void 0!==t?t:[],ke=V[H||X],Ne=function(e,t){var n=e.map((function(e){return e.estimate})).filter((function(e){return!!e})).filter((function(e){return Object(L.c)(e)})).map((function(e){return Number(e)})),a=n.reduce((function(e,t){return e+Number(t)}),0),r=n.length>0?a/n.length:0;return{values:n,estimatesSum:a,estimatesAverage:Math.round(10*r+Number.EPSILON)/10,isEstimatesCleared:e.length>0&&e.every((function(e){return void 0===e.estimate})),isUserMemberOfRoom:!(null===t||void 0===t||!t.trim())&&e.some((function(e){return e.username===t}))}}(xe,I),Pe=Ne.estimatesAverage,ye=Ne.isEstimatesCleared,Ce=Ne.isUserMemberOfRoom,Se=J&&Object(L.b)(N)&&Object(L.b)(g)&&Object(L.b)(x),we=Se&&Object(L.b)(I),Ie=Object(L.b)(R)&&Object(L.b)(S);Object(y.useEffect)((function(){Se&&(M("lastPokerPlanningRoomName",null!==N&&void 0!==N?N:""),M("lastPokerPlanningHostName",null!==g&&void 0!==g?g:""))}),[x,N,g,M,Se]),Object(y.useEffect)((function(){if(Oe&&I){W.a&&console.info("poker session",Oe);var e=null===Oe||void 0===Oe?void 0:Oe.estimates.find((function(e){return e.username===I}));e&&Z(e.estimate)}}),[I,Oe]),Object(y.useEffect)((function(){if(Se)return J.current=function(e){var t=e.hostName,n=void 0===t?z:t,a=e.roomUUID,r=void 0===a?Object(le.a)():a,o=e.onSocketStateUpdate,i=e.onSessionUpdate,c="https:"===document.location.protocol?"wss":"ws",s="".concat(c,"://").concat(n,"/ws?roomUUID=").concat(r),l=new se.a(s);return l.onopen=function(){return o(ue(l.readyState))},l.onerror=function(){return o(ue(l.readyState))},l.onclose=function(){return o(ue(l.readyState))},l.onmessage=function(e){var t=JSON.parse(e.data);i(t)},l}({hostName:g,roomUUID:x,onSessionUpdate:ge,onSocketStateUpdate:_}),function(){var e;return null===(e=J.current)||void 0===e?void 0:e.close()}}),[J,Se,g,x]);Object(y.useEffect)((function(){ye&&(fe(!1),Z(void 0))}),[ye]);var Ue=function(e){J.current&&"open"===G?J.current.send(JSON.stringify(e)):ne(e)};return Object(y.useEffect)((function(){J.current&&"open"===G&&te&&(J.current.send(JSON.stringify(te)),ne(void 0))}),[te,G]),Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(C.a,{title:ve}),Object(F.jsxs)("div",{className:n.root,children:[Object(F.jsx)(E.a,{iconType:O.a,title:ve}),Object(F.jsxs)(r.a,{container:!0,children:[Object(F.jsx)(r.a,{item:!0,md:9,xs:12,children:Object(F.jsx)(ce,{socketState:G})}),Object(F.jsx)(r.a,{item:!0,md:3,xs:12,children:Object(F.jsxs)(r.a,{container:!0,justifyContent:"flex-end",alignItems:"center",className:n.toolbar,children:[Object(F.jsx)(j.a,{variant:"contained",title:"Register the team and start planning in a new room",color:"primary",disabled:!Ie,onClick:function(){var e=de({hostName:R,roomName:S});b(e,{replace:!0})},children:"New"}),Object(F.jsx)(j.a,{variant:"contained",title:"Enter existing room",color:"primary",disabled:Ce||!we,onClick:function(){return Ue(D(I))},children:"Join"}),Object(F.jsx)(T.a,{isDisabled:!Se,data:me({hostName:g,roomUUID:x,roomName:N}),Icon:v.a,hoverMessage:"Copy link to clipboard for sharing",feedbackMessage:"Link copied to clipboard, you can now share to all members"})]})})]}),Object(F.jsx)("div",{className:n.submitEstimate,children:ke.values.map((function(e){return Object(F.jsx)(Y,{isDisabled:!we,isSelected:Q===e,value:e,onClick:function(){return function(e){e!==Q?(Z(e),Ue(D(I,e))):(Z(void 0),Ue(D(I)))}(e)}},e)}))}),Object(F.jsx)(o.a,{component:i.a,className:n.teamEstimates,children:Object(F.jsxs)(c.a,{size:"small",children:[Object(F.jsx)(s.a,{className:n.tableHeader,children:Object(F.jsxs)(l.a,{children:[Object(F.jsx)(re,{component:"th",scope:"row",width:30}),Object(F.jsx)(re,{component:"th",scope:"row",children:"Team member"}),Object(F.jsxs)(re,{component:"th",scope:"row",align:"center",children:["Points",Object(F.jsx)(u.a,{title:"Toggle story points visibility",onClick:function(){return fe((function(e){return!e}))},children:je?Object(F.jsx)(P.a,{}):Object(F.jsx)(k.a,{})}),Object(F.jsx)(u.a,{onClick:function(){return f({title:"Confirmation",description:"Are you sure you want to delete all votes?",onConfirm:function(){return Ue({type:"reset"})}})},title:"Clear all votes",children:Object(F.jsx)(p.a,{})})]})]})}),Object(F.jsxs)(d.a,{children:[xe.sort(ke.sorter).map((function(e){var t=e.username,n=e.estimate,a=null!==n&&void 0!==n?n:"\u2026",r=n?"\u2714":"\u2026";return Object(F.jsxs)(oe,{children:[Object(F.jsx)(re,{width:30,children:Object(F.jsx)(u.a,{onClick:function(){return Ue(function(){return{type:"remove",payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""}}(t))},title:'Remove user "'.concat(t,'"'),children:Object(F.jsx)(p.a,{})})}),Object(F.jsx)(re,{children:t}),Object(F.jsx)(re,{align:"center",children:je?a:r})]},t)})),Object(F.jsxs)(oe,{children:[Object(F.jsx)(re,{width:30}),Object(F.jsx)(re,{children:Object(F.jsx)(m.a,{children:"Story points average"})}),Object(F.jsx)(re,{align:"center",children:Object(F.jsx)(m.a,{children:je?Pe:""})})]},"average")]})]})})]})]})})))},301:function(e,t,n){"use strict";var a=n(64),r=n(260),o=(n(0),n(2)),i=Object(r.a)((function(e){return{title:{wordBreak:"break-word"},titleWithIcon:{display:"flex",alignItems:"center"},titleContainer:{display:"flex",justifyContent:"center"},icon:{height:"40px",width:"40px",marginRight:e.spacing(1)}}}));t.a=function(e){var t=i(),n=e.iconType;return Object(o.jsx)("div",{className:t.titleContainer,children:Object(o.jsxs)("div",{className:t.titleWithIcon,children:[Object(o.jsx)(n,{className:t.icon}),Object(o.jsx)(a.a,{variant:"h5",className:t.title,children:e.title})]})})}},304:function(e,t,n){"use strict";var a=n(266),r=n(311),o=n.n(r),i=n(307),c=n.n(i),s=(n(0),n(96)),l=n(2);t.a=function(e){var t=e.data,n=e.isDisabled,r=e.hoverMessage,i=e.feedbackMessage,u=e.Icon,d=void 0===u?o.a:u,m=Object(s.c)().setToasterState;return Object(l.jsx)(a.a,{onClick:function(){if(t){var e=null!==i&&void 0!==i?i:"Content copied into clipboard: ".concat(t.substring(0,25)," \u2026");c.a(t,{format:"text/plain"}),m({open:!0,message:e,type:"success",autoHideDuration:2e3})}},disabled:!t||n,title:null!==r&&void 0!==r?r:"Copy to clipboard",variant:"contained",color:"primary",children:Object(l.jsx)(d,{})})}},373:function(e,t,n){"use strict";function a(e){return!e||0===e.trim().length}function r(e){return!a(e)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var o=function(e){return!isNaN(Number(e))}}}]);
//# sourceMappingURL=35.41bf4dd8.chunk.js.map